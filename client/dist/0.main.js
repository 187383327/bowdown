(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,function(e,t,o){"use strict";o.r(t);var n=o(3),i=o(6),a=o.n(i),r=new(o(7).a);function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}const l=!1;function s(e,t){if(l){var o=new n.s;o.vertices.push(t,new n.ub);var i=new n.B({color:16711680}),a=new n.A(o,i);a.name="collision line",e.gltf.scene.add(a)}}var u=o(4),d=o.n(u),p=o(8),m=o.n(p),g=o(9),w=o.n(g),f=o(10),h=o.n(f),y=o(11),b=o.n(y),v=o(12),x=o.n(v),k=o(13),A=o.n(k),S=new n.jb;S.loaded=!1;var L=[];r.load(d.a,function(e){var t=e.scene;t.position.y-=10,S.add(t),L.push(t),S.loaded=!0});let M=[];M.push(new n.O({map:(new n.pb).load(m.a)})),M.push(new n.O({map:(new n.pb).load(w.a)})),M.push(new n.O({map:(new n.pb).load(h.a)})),M.push(new n.O({map:(new n.pb).load(b.a)})),M.push(new n.O({map:(new n.pb).load(x.a)})),M.push(new n.O({map:(new n.pb).load(A.a)}));for(let e=0;e<6;e++)M[e].side=n.e;let z=new n.g(5e3,5e3,5e3),P=new n.N(z,M);var j;S.add(P),S.add(((j=new n.u(16777215,10209703)).color.setHSL(.6,1,.8),j.groundColor.setHSL(.095,1,.75),j.position.set(-690,-450,-240),j.visible=!0,j));B();function B(){var e=new n.n(16777215,3);e.color.setHSL(.1,1,.95),e.position.set(230,150,80),e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048;return e.shadow.camera.left=-50,e.shadow.camera.right=50,e.shadow.camera.top=50,e.shadow.camera.bottom=-50,e.shadow.camera.far=3500,e.shadow.bias=-1e-4,e.visible=!0,e}S.add(B()),S.animate=function(e){P.applyQuaternion((new n.db).setFromAxisAngle(new n.ub(0,1,0),e/20))};var E,O;E=window.innerWidth,O=window.innerHeight;var F=new n.X(75,E/O,.1,1e4);F.listener=new n.c,F.add(F.listener),F.zoomState="out";var C=F.getFocalLength(),q=F.getFocalLength()+16;F.position.z=5;var R=new n.ub,_=0,D=0;function H(e,t){var o;return e.gltf.animations.forEach(e=>{e.name!==t||(o=e)}),null==o&&console.error("animation: "+t+" cannot be found!"),o}function I(e,t){t.mixer=e,t.anim={idle:e.clipAction(H(t,"Idle")),running:e.clipAction(H(t,"Running best")),runWithBow:e.clipAction(H(t,"Running with bow best")),runWithLegsOnly:e.clipAction(H(t,"Running legs only")),jumping:e.clipAction(H(t,"Jumping2")).setLoop(n.J),equipBow:e.clipAction(H(t,"Equip Bow")).setLoop(n.J),drawBow:e.clipAction(H(t,"Draw bow")).setLoop(n.J),fireBow:e.clipAction(H(t,"Fire bow")).setLoop(n.J),death:e.clipAction(H(t,"death")).setLoop(n.J)},t.anim.drawBow.clampWhenFinished=!0,t.toggleBow=function(e){t.gltf.scene.children[0].children[1].visible=!e,t.gltf.scene.children[0].children[2].visible=e},t.isRunning=function(){return!!t.activeMovement&&t.activeMovement.toLowerCase().includes("run")},t.isFiring=function(){return t.bowState&&("drawn"==t.bowState||"drawing"==t.bowState||"firing"==t.bowState)},t.getPosition=function(){if(t.gltf)return t.gltf.scene.position.clone();console.error("archer.gltf has not been defined yet")},t.setPosition=function(e){null!=t.gltf?t.gltf.scene.position.copy(e):console.error("archer.gltf has not been defined yet")},t.getRotation=function(){if(t.gltf)return t.gltf.scene.rotation;console.error("archer.gltf has not been defined yet")},t.globalVector=function(e){return e.clone().applyEuler(this.getRotation())}}function W(e){var t=document.createTextNode(e),o=document.createElement("p");o.className="message",o.appendChild(t),document.getElementById("chat").appendChild(o)}F.nextPosition=function(e){if(null!=Pe){var t=new n.ub;return t.x=e*Math.sin(_*Math.PI/360)*Math.cos(D*Math.PI/360),t.y=e*Math.sin(D*Math.PI/360),t.z=e*Math.cos(_*Math.PI/360)*Math.cos(D*Math.PI/360),R.clone().add(t.applyQuaternion((new n.db).setFromUnitVectors(new n.ub(0,1,0),R.clone().normalize())))}},F.zoomIn=function(){F.zoomState="zooming in"},F.zoomOut=function(){F.zoomState="zooming out"},F.resetFocalLength=function(){C=F.getFocalLength(),q=F.getFocalLength()+16},F.resetFocalLength(),F.animate=function(e){if("zooming in"==F.zoomState){if(F.getFocalLength()<q){var t=60;Pe.doubleJumped&&(t/=2),(o=F.getFocalLength()+e*t)<q?F.setFocalLength(o):(F.setFocalLength(q),F.zoomState="in")}}else if("zooming out"==F.zoomState){var o;if(F.getFocalLength()>C)(o=F.getFocalLength()-60*e)>C?F.setFocalLength(o):(F.setFocalLength(C),F.zoomState="out")}},F.setPosition=function(e){F.position.copy(e)},F.updateCamera=function(){if(null!=Pe){var e=Pe.getPosition().sub(F.position.clone()),t=Pe.getPosition().normalize().cross(e).normalize().multiplyScalar(-.5);R.copy(Pe.getPosition().add(t).add(Pe.getPosition().normalize().multiplyScalar(1.8)));var o=F.nextPosition(3.5),i=new n.hb(R,o.clone().sub(R).normalize(),0,3.5).intersectObjects(L,!0);i.length>0&&(o=i[0].point.clone().sub(o.clone().sub(i[0].point).normalize().multiplyScalar(.1))),F.setPosition(o)}F.up.copy(Pe.getPosition().normalize()),F.lookAt(R),F.updateMatrix()},F.moveCamera=function(e,t){_-=.2*e;var o=D+.2*t;140>o&&o>-145&&(D=o),F.updateCamera()};const J=new WebSocket("wss://ws.bowdown.io:18181");function U(e){1==J.readyState?J.send(JSON.stringify(e)):console.error("error connecting to server")}J.onmessage=function(e){var t,o,i;if((e=JSON.parse(e.data)).players&&T.init(e.players),e.player){var a=e.player;a==Pe.uuid?e.damage?Pe.takeDamage(e.damage):e.kills&&Ye(e.kills):e.chatMessage?W(e.chatMessage):"disconnected"===e.status?(S.remove(T.get(a).gltf.scene),T.get(a)):T.get(a)?T.get(a).gltf&&e.position&&null!=e.rotation?T.move(a,e.position,e.rotation):T.get(a).gltf&&e.playAction?T.playAction(a,e.playAction):T.get(a).gltf&&e.stopAction&&T.stopAction(a,e.stopAction):T.add(a,e.position,e.race)}else e.arrow&&(e.arrow.stopped?(i=e.arrow,oe[i.uuid].position.copy(i.position),oe[i.uuid].stopped=!0):(t=e.arrow,(o=le(t.origin,t.rotation,t.type)).uuid=t.uuid,o.player=t.player,o.velocity=new n.ub(t.velocity.x,t.velocity.y,t.velocity.z),oe[o.uuid]=o,ue(o,(Date.now()-t.timeOfShoot)/1e3)))};o(5);var T={},X={},V=[];T.all=function(){return X},T.get=e=>X[e],T.add=function(e,t,o){X[e]={},null==o&&(console.error("race is undefined"),o="brown"),r.load("./models/benji_"+o+".gltf",function(o){X[e].gltf=o,I(new n.b(o.scene),X[e]),t&&T.move(e,t,0),S.add(o.scene);var i=new n.N(new n.g(.5,2,.5));i.position.y+=1,i.material.visible=!1,o.scene.add(i),i.playerUuid=e,V.push(i)})},T.init=function(e){Object.keys(e).forEach(t=>{T.add(t,e[t].position,e[t].race)})},T.move=function(e,t,o){var n=X[e];n.gltf.scene.position.copy(t),n.gltf.scene.rotation.copy(o)},T.playAction=function(e,t){X[e].anim[t].reset().play()},T.stopAction=function(e,t){X[e].anim[t].stop()};var Y=new n.d;function N(e){var t=new n.bb(F.listener);return Y.load(e,function(e){t.setBuffer(e),t.setRefDistance(5)}),t}var G=o(24),Q=o.n(G),K=o(25),Z=o.n(K),$=o(26),ee=o.n($),te=[],oe=[],ne=.06,ie=.75;const ae=new n.ub(0,1.5,0),re={normal:{color:65280},rope:{color:16743168}};new n.d;var ce={};function le(e,t,o){re[o]||console.error("arrow type: "+o+" does not exist");var i=new n.g(ne,ne,ie),a=new n.O({color:re[o].color}),r=new n.N(i,a);return"rope"==o?r.add(ce.grappleHit):r.add(ce.arrowHitGround),r.add(ce.arrowHitPlayer),r.origin=e,r.position.copy(e),r.rotation.copy(t),S.add(r),r.type=o,r}function se(e){var t=Pe.getPosition().add(pe()),o=le(t,F.rotation,e);o.uuid=c(),o.playerUuid=Pe.uuid;var i=new n.hb;i.setFromCamera({x:0,y:0},F);var a,r=i.intersectObjects(L.concat(V),!0);return r.length>0?a=r[0].point.sub(t):(a=new n.ub,F.getWorldDirection(a)),o.velocity=a.normalize().multiplyScalar(60),te.push(o),U({arrow:{type:e,origin:o.position,uuid:o.uuid,player:Pe.uuid,rotation:o.rotation,velocity:o.velocity,timeOfShoot:Date.now()}}),o}function ue(e,t){e.velocity.sub(e.position.clone().normalize().multiplyScalar(9*t)),e.position.add(e.velocity.clone().multiplyScalar(t))}function de(e){te.forEach(t=>{if("rope"==t.type){t.rope&&S.remove(t.rope);var o=new n.s,i=new n.B({color:16775912,linewidth:10});o.vertices.push(Pe.getPosition().add(pe()),t.position);var a=new n.A(o,i);t.rope=a,S.add(a)}if(!t.stopped){ue(t,e);var r=new n.ub(0,0,1);r.applyEuler(t.rotation).normalize();var c=t.position.clone().sub(t.origin).length()/2,l=new n.hb(t.position,r,0,c),s=l.intersectObjects(V);if(s.length>0){var u=s.pop();t.position.copy(u.point),ce.arrowHitPlayer.play(),t.stopped=!0,function(e){U({player:e,damage:100})}(u.object.playerUuid)}(s=l.intersectObjects(L,!0)).length>0&&(t.position.copy(s.pop().point),"rope"==t.type?ce.grappleHit.play():ce.arrowHitGround.play(),t.stopped=!0,U({arrow:{stopped:!0,position:t.position,uuid:t.uuid}}))}}),Object.keys(oe).forEach(t=>{oe[t].stopped||ue(oe[t],e)})}function pe(){return Pe.globalVector(ae)}ce.arrowHitGround=N(Q.a),ce.arrowHitPlayer=N(Z.a),ce.grappleHit=N(ee.a);var me=o(27),ge=o.n(me),we=o(28),fe=o.n(we),he=o(29),ye=o.n(he),be=o(30),ve=o.n(be);const xe=o(5);var ke={uuid:c()};const Ae=7,Se=1.3,Le=15,Me=new n.ub(230,150,80).multiplyScalar(.75);var ze={};ze.bowShot=N(ge.a),ze.bowDraw=N(fe.a),ze.grappleShot=N(ye.a),ze.grappleReel=N(ve.a),ke.race=["black","brown","white"][Math.floor(3*Math.random())],r.load(xe("./benji_"+ke.race+".gltf"),e=>{ke.gltf=e,Object.keys(ze).forEach(e=>ke.gltf.scene.add(ze[e])),ke.velocity=new n.ub,ke.bowState="unequipped";var t,o=new n.b(e.scene);function i(e,t,o,n){return e.clone().projectOnPlane(ke.getPosition().normalize()).applyAxisAngle(ke.getPosition().normalize(),-Math.atan2(t.x,t.y)).normalize().multiplyScalar(n*function(e){return e.keyboard.shift?(ke.isRunning()&&(ke.anim[ke.activeMovement].timeScale=Se),Ae*Se):(ke.anim[ke.activeMovement]&&(ke.anim[ke.activeMovement].timeScale=1),Ae)}(o))}function a(e,t){var o,i;i=e?e.clone().normalize():ke.getPosition().normalize(),t?(ke.getRotation().copy(new n.p(0,t,0)),o=(new n.db).setFromUnitVectors(new n.ub(0,1,0),i)):e&&(o=(new n.db).setFromUnitVectors(ke.getPosition().normalize(),i)),o&&ke.gltf.scene.applyQuaternion(o)}I(o,ke),o.addEventListener("finished",e=>{"Draw bow"==e.action.getClip().name?ke.bowState="drawn":"death"==e.action.getClip().name?S.remove(ke.gltf.scene):("Fire bow"==e.action.getClip().name&&(ke.bowState="equipped"),ke.idle())}),ke.falling=function(e){if(e){var t=ke.getPosition().add(ke.velocity.clone().multiplyScalar(e)).sub(this.globalVector(new n.ub(0,.1,0))),o=this.globalVector(new n.ub(0,1,0));return!(new n.hb(t,o,0,.2+ke.velocity.length()*e).intersectObjects(L,!0).length>0)||(ke.doubleJumped=!1,!1)}},ke.collisionDetected=function(e){var t,o,i;t=ke,l&&t.gltf.scene.children.forEach(e=>{"collision line"===e.name&&t.gltf.scene.remove(e)});for(var a=-1;a<=1;a++)for(var r=-1;r<=1;r++){if(o=this.globalVector(new n.ub(.5*a,1,.5*r).normalize()),i=new n.hb(e,o,0,1),s(ke,o),i.intersectObjects(L,!0).length>0)return o;var c=e.clone().sub(ke.getPosition());if((i=new n.hb(ke.getPosition().add(o),c.clone().normalize(),0,c.length())).intersectObjects(L,!0).length>0)return c}return!1},ke.playBowAction=function(e){ke.isRunning()&&"runWithLegsOnly"!=ke.activeMovement?ke.movementAction("runWithLegsOnly"):ke.activeMovement&&(ke.stopAction(ke.activeMovement),ke.activeMovement=null),ke.bowAction(e),ke.broadcast()},ke.onMouseDown=function(){null!=t?(t=null,te.forEach(e=>{"rope"==e.type&&(e.type=null,S.remove(e.rope))}),ze.grappleReel.isPlaying&&ze.grappleReel.stop()):"unequipped"==ke.bowState?ke.equipBow():(this.activeActions.includes("jumping")&&this.stopAction("jumping"),ze.bowDraw.play(),ke.playBowAction("drawBow"),ke.bowState="drawing",F.zoomIn())},ke.onMouseUp=function(e){"drawn"==ke.bowState?(ke.playBowAction("fireBow"),2==e.button?(t=se("rope"),ze.grappleShot.play()):(ze.bowShot.play(),se("normal")),ke.bowState="firing",F.zoomOut()):"drawing"===ke.bowState&&(ke.stopAction(ke.activeBowAction),ke.activeBowAction=null,ke.bowState="equipped",ke.idle(),F.zoomOut())},ke.broadcast=async function(){U({player:ke.uuid,position:ke.getPosition(),rotation:ke.getRotation(),bowState:ke.bowState})},ke.doubleJumped=!1,ke.animate=function(e,o){var r,c,l=function(e){var t=0,o=0;if(0!=e.touch.x&&0!=e.touch.y){var i=new n.tb(e.touch.x,e.touch.y);i.length()>100?e.keyboard.shift=!0:e.keyboard.shift=!1,i.normalize(),t=i.x,o=i.y}return e.keyboard.forward&&(t+=0,o+=1),e.keyboard.backward&&(t+=0,o+=-1),e.keyboard.left&&(t+=-1,o+=0),e.keyboard.right&&(t+=1,o+=0),new n.tb(t,o)}(o),s=F.getWorldDirection(new n.ub),u=i(s,l,o,e),d=function(e){var t=e.clone();return t.applyQuaternion((new n.db).setFromUnitVectors(R.clone().normalize(),new n.ub(0,1,0))),new n.tb(t.x,t.z)}(s),p=function(e,t,o){return 0==t.length()&&(t=new n.tb(0,1)),e.clone().rotateAround(new n.tb,Math.atan2(t.x,t.y))}(d,l),m=ke.falling(e);if(!m&&S.loaded)if(0!=o.touch.x&&0!=o.touch.y||o.keyboard.forward||o.keyboard.backward||o.keyboard.left||o.keyboard.right){c=Math.atan2(p.x,p.y),ke.velocity.set(0,0,0),(r=ke.getPosition()).add(u);var g=r.clone().add(this.globalVector(new n.ub(0,.5,0))),w=new n.hb(g,this.globalVector(new n.ub(0,-1,0)),0,1).intersectObjects(L,!0);w.length>0&&(r=w[0].point.add(this.globalVector(new n.ub(0,.01,0)))),ke.isRunning()||("equipped"==ke.bowState?ke.movementAction("runWithBow"):ke.isFiring()?ke.movementAction("runWithLegsOnly"):ke.movementAction("running"))}else ke.isRunning()&&(ke.isFiring()?(ke.stopAction(ke.activeMovement),ke.activeMovement=null):ke.idle());else{var f=10;ke.doubleJumped&&ke.isFiring()&&(f=5),ke.velocity.sub(ke.getPosition().normalize().multiplyScalar(f*e))}if(ke.isFiring()&&(c=Math.atan2(d.x,d.y),F.updateCamera(),ke.broadcast()),o.jump&&!ke.doubleJumped&&(o.jump=null,m&&(ke.doubleJumped=!0),l.length()&&this.velocity.copy(u.clone().multiplyScalar(1/e)),this.velocity.add(this.getPosition().normalize().multiplyScalar(5)),this.playAction("jumping")),function(e,o,n){if(0!=ke.velocity.length()){if(null!=t&&t.stopped){if(0!=o.length()){var i=n.clone().applyAxisAngle(ke.getPosition().normalize(),-Math.atan2(o.x,o.y));ke.velocity.add(i.multiplyScalar(Le*e))}var a=t.position.clone().sub(ke.getPosition());ke.velocity.add(a.normalize().multiplyScalar(Le*e)),ke.velocity.angleTo(a)>Math.PI/2&&ke.velocity.projectOnPlane(a.clone().normalize()),ze.grappleReel.isPlaying||ze.grappleReel.play()}return ke.velocity.clone().multiplyScalar(e)}}(e,l,s)&&(r||(r=ke.getPosition()),r.add(ke.velocity.clone().multiplyScalar(e))),r){var h=ke.collisionDetected(r);h?m?(ke.velocity.copy(h.clone().negate().normalize().multiplyScalar(10)),r.add(ke.velocity.clone().multiplyScalar(e)),ke.setPosition(r)):ke.velocity.set(0,0,0):function(e,t){a(e,t),ke.setPosition(e),F.updateCamera()}(r,c),ke.broadcast()}else c&&a(r,c)},ke.idle=function(){ke.movementAction("idle"),ke.broadcast()},ke.equipBow=function(){ke.bowState="equipped",ke.playBowAction("equipBow"),ke.toggleBow(!0)},ke.unequipBow=function(){ke.toggleBow(!1),ke.bowState="unequipped"},ke.takeDamage=function(){Ne(),this.playAction("death")},ke.respawn=function(){S.add(ke.gltf.scene),ke.setPosition(Me)},ke.sendChat=function(e){U({player:ke.uuid,chatMessage:e})},ke.activeActions=[],ke.playAction=function(e){this.anim[e]&&(this.anim[e].reset().play(),U({player:this.uuid,playAction:e}),this.activeActions.includes(e)||this.activeActions.push(e))},ke.stopAction=function(e){this.activeActions.includes(e)?(this.activeActions=this.activeActions.filter(t=>t!=e),this.anim[e].stop(),U({player:this.uuid,stopAction:e})):console.error("tried to stop action: "+e+", but action was never started")},ke.bowAction=function(e){this.anim&&this.anim[e]?this.activeBowAction!=e&&(this.activeBowAction&&(this.stopAction(this.activeBowAction),this.activeBowAction=null),this.activeMovement&&"runWithLegsOnly"!=this.activeMovement&&this.stopAction(this.activeMovement),e&&this.playAction(e),this.activeBowAction=e):console.error("action: "+e+" does not exist!")},ke.movementAction=function(e="idle"){if(this.anim&&this.anim[e]){if(this.activeMovement){if(this.activeMovement==e)return;this.stopAction(this.activeMovement)}this.playAction(e),this.activeMovement=e}else console.error("action: "+e+" does not exist!")},ke.setPosition(Me),ke.gltf.scene.applyQuaternion((new n.db).setFromUnitVectors(new n.ub(0,1,0),ke.getPosition().normalize())),S.add(ke.gltf.scene),U({player:ke.uuid,position:ke.getPosition(),race:ke.race}),ke.equipBow(),ke.idle()});var Pe=ke,je=new n.xb({antialias:!0,alpha:!0});je.setClearColor("#e5e5e5"),je.setSize(window.innerWidth,window.innerHeight,!1),je.setPixelRatio(window.devicePixelRatio),je.gammaOutput=!0,je.gammaFactor=2.2,o.d(t,"start",function(){return et}),o.d(t,"gameOver",function(){return Ne}),o.d(t,"setKillCount",function(){return Ye}),o(31);var Be=new n.k;window.addEventListener("resize",function(){var e,t;e=window.innerWidth,t=window.innerHeight,He&&window.innerWidth>window.innerHeight?(He=!1,document.body.classList.remove("rotated")):He&&(e=window.innerHeight,t=window.innerWidth);je.setSize(e,t,!1),F.aspect=e/t,F.resetFocalLength(),F.updateProjectionMatrix()});var Ee={keyboard:{forward:!1,backward:!1,left:!1,right:!1,space:!1},touch:{x:0,y:0}},Oe="playing",Fe=!1,Ce={id:null,x:null,y:null,shoot:!1},qe={id:null,x:null,y:null},Re={id:null};const _e=4,De=[document.getElementById("shoot-button"),document.getElementById("rope-button"),document.getElementById("jump-button")];var He;function Ie(){requestAnimationFrame(Ie);var e=Be.getDelta();de(e),Pe&&Pe.mixer&&(Pe.animate(e,Ee),Pe.mixer.update(e)),Object.keys(T.all()).length&&function(e){Object.keys(X).forEach(t=>{X[t].mixer&&X[t].mixer.update(e)})}(e),F.animate(e),S.animate(e),je.render(S,F)}function We(e,t){if("string"==typeof e.key)switch(e.key.toLowerCase()){case"w":Ee.keyboard.forward=t;break;case"a":Ee.keyboard.left=t;break;case"s":Ee.keyboard.backward=t;break;case"d":Ee.keyboard.right=t;break;case" ":null!=Ee.jump?Ee.jump=t:t||(Ee.jump=!1);break;case"shift":Ee.keyboard.shift=t}}function Je(e){if(13===e.keyCode&&document.getElementById("chat").classList.contains("chatting")){var t=document.getElementById("chat-text-box");Pe.sendChat(t.value),W(t.value),t.value="",document.getElementById("chat").classList.remove("chatting")}We(e,!0)}function Ue(e){We(e,!1)}function Te(){"chat"==event.target.id||"chat"==event.target.parentElement.id?document.getElementById("chat").classList.add("chatting"):(document.getElementById("chat").classList.remove("chatting"),2!=event.button&&"paused"==Oe&&(document.body.requestPointerLock&&document.body.requestPointerLock(),Ve()),"playing"==Oe&&Pe.onMouseDown())}function Xe(e){"playing"===Oe&&Pe.onMouseUp(e)}function Ve(){document.body.classList.remove("ready"),document.body.classList.add("playing"),Oe="playing"}function Ye(e){e,document.getElementById("kill-count").innerHTML+="X"}function Ne(){Oe="gameOver",document.body.classList.remove("playing"),document.getElementById("title").innerHTML="Game over",document.body.classList.remove("playing"),document.body.classList.add("gameOver")}function Ge(){Oe=document.pointerLockElement?"playing":"paused"}function Qe(e){e!=Fe&&(e?De.forEach(e=>e.setAttribute("style","display: block;")):De.forEach(e=>e.setAttribute("style","display: none;")),Fe=e)}function Ke(e){var t,o,n;e.preventDefault(),Qe(!0);for(var i=0;i<e.targetTouches.length;i++)e.targetTouches.item(i).identifier==Ce.id?t=e.targetTouches.item(i):e.targetTouches.item(i).identifier==qe.id?o=e.targetTouches.item(i):null==n&&(n=e.targetTouches.item(i));t?(He?F.moveCamera(_e*(t.pageY-Ce.y),-1*_e*(t.pageX-Ce.x)):F.moveCamera(_e*(t.pageX-Ce.x),_e*(t.pageY-Ce.y)),Ce.x=t.pageX,Ce.y=t.pageY):n&&("shoot-button"===n.target.id?(Pe.onMouseDown(),Ce.shoot=!0):"rope-button"===n.target.id&&(Pe.onMouseDown(),Ce.rope=!0),"jump-button"===n.target.id&&(Ee.jump=!0,Re.id=n.identifier),(He&&n.pageY>window.innerHeight/2||!He&&n.pageX>window.innerWidth/2)&&(Ce.id=n.identifier,Ce.x=n.pageX,Ce.y=n.pageY)),o?He?(Ee.touch.y=o.pageX-qe.x,Ee.touch.x=o.pageY-qe.y):(Ee.touch.x=o.pageX-qe.x,Ee.touch.y=-1*(o.pageY-qe.y)):n&&(He&&n.pageY<window.innerHeight/2||!He&&n.pageX<window.innerWidth/2)&&(qe.id=n.identifier,qe.x=n.pageX,qe.y=n.pageY)}function Ze(e){Ce.id==e.changedTouches[0].identifier?(Ce.id==Re.id&&(Ee.jump=!1),Ce.shoot&&Pe.onMouseUp({button:0}),Ce.rope&&Pe.onMouseUp({button:2}),Ce.id=null,Ce.shoot=!1,Ce.rope=!1):qe.id==e.changedTouches[0].identifier&&(qe.id=null,Ee.touch={x:0,y:0})}function $e(e){"shoot-button"!=e.target.id&&"jump-button"!=e.target.id&&"rope-button"!=e.target.id&&Qe(!1);var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,o=e.movementY||e.mozMovementY||e.webkitMovementY||0;F.moveCamera(t,o)}function et(){document.addEventListener("mousemove",$e),document.addEventListener("keydown",Je),document.addEventListener("keyup",Ue),document.addEventListener("mousedown",Te),document.addEventListener("mouseup",Xe),document.addEventListener("pointerlockchange",Ge),document.addEventListener("touchstart",Ke),document.addEventListener("touchmove",Ke),document.addEventListener("touchend",Ze),document.body.appendChild(je.domElement),De.concat(je.domElement).forEach(e=>new a.a.Manager(e,{recognizers:[[a.a.Pinch,{enable:!0}]]})),window.innerWidth<window.innerHeight&&document.body.requestPointerLock&&document.body.requestPointerLock()&&screen.orientation.type&&screen.orientation.type.includes("portrait")&&(document.body.requestFullscreen?document.body.requestFullscreen():document.body.mozRequestFullScreen?document.body.mozRequestFullScreen():document.body.webkitRequestFullscreen?document.body.webkitRequestFullscreen():document.body.msRequestFullscreen&&document.body.msRequestFullscreen(),document.body.classList.add("rotated"),He=!0),Ie(),Ve()}Ee.jump=0,document.getElementById("respawn").onclick=function(){Pe.respawn(),Ve()}},,function(e,t,o){e.exports=o.p+"models/battle_planet.glb"},function(e,t,o){var n={"./Characters_Black.png":14,"./Characters_Brown.png":15,"./Characters_White.png":16,"./battle_planet.glb":4,"./benji.bin":17,"./benji.gltf":18,"./benji_black.gltf":19,"./benji_brown.gltf":20,"./benji_white.gltf":21,"./env.glb":22,"./lowild.glb":23};function i(e){var t=a(e);return o(t)}function a(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=a,e.exports=i,i.id=5},,,function(e,t,o){e.exports=o.p+"skybox/yellowcloud_ft.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_bk.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_up.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_dn.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_rt.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_lf.jpg"},function(e,t,o){e.exports=o.p+"models/Characters_Black.png"},function(e,t,o){e.exports=o.p+"models/Characters_Brown.png"},function(e,t,o){e.exports=o.p+"models/Characters_White.png"},function(e,t,o){e.exports=o.p+"models/benji.bin"},function(e,t,o){e.exports=o.p+"models/benji.gltf"},function(e,t,o){e.exports=o.p+"models/benji_black.gltf"},function(e,t,o){e.exports=o.p+"models/benji_brown.gltf"},function(e,t,o){e.exports=o.p+"models/benji_white.gltf"},function(e,t,o){e.exports=o.p+"models/env.glb"},function(e,t,o){e.exports=o.p+"models/lowild.glb"},function(e,t,o){e.exports=o.p+"audio/effects/Arrow to Ground.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Arrow to Player.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Grapple Hit.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Bow Shot.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Bow Draw.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Grapple Shot.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Grapple Reel Loop.mp3"},function(e,t,o){var n={"./bow-and-arrow.svg":32,"./crosshair.svg":33,"./dot-and-circle.svg":34,"./fullscreen.svg":35,"./rope.svg":36};function i(e){var t=a(e);return o(t)}function a(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=a,e.exports=i,i.id=31},function(e,t,o){e.exports=o.p+"icons/bow-and-arrow.svg"},function(e,t,o){e.exports=o.p+"icons/crosshair.svg"},function(e,t,o){e.exports=o.p+"icons/dot-and-circle.svg"},function(e,t,o){e.exports=o.p+"icons/fullscreen.svg"},function(e,t,o){e.exports=o.p+"icons/rope.svg"}]]);