(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,function(e,t,o){"use strict";o.r(t);var n=o(3),i=o(6),a=o.n(i),r=new(o(7).a);function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}const l=!1;var s=o(4),u=o.n(s),d=o(8),p=o.n(d),m=o(9),g=o.n(m),w=o(10),h=o.n(w),f=o(11),y=o.n(f),b=o(12),v=o.n(b),x=o(13),k=o.n(x),A=new n.jb;A.loaded=!1;var S=[];r.load(u.a,function(e){var t=e.scene;t.position.y-=10,A.add(t),S.push(t),A.loaded=!0});let L=[];L.push(new n.O({map:(new n.pb).load(p.a)})),L.push(new n.O({map:(new n.pb).load(g.a)})),L.push(new n.O({map:(new n.pb).load(h.a)})),L.push(new n.O({map:(new n.pb).load(y.a)})),L.push(new n.O({map:(new n.pb).load(v.a)})),L.push(new n.O({map:(new n.pb).load(k.a)}));for(let e=0;e<6;e++)L[e].side=n.e;let M=new n.g(5e3,5e3,5e3),z=new n.N(M,L);var P;A.add(z),A.add(((P=new n.u(16777215,10209703)).color.setHSL(.6,1,.8),P.groundColor.setHSL(.095,1,.75),P.position.set(-690,-450,-240),P.visible=!0,P));j();function j(){var e=new n.n(16777215,3);e.color.setHSL(.1,1,.95),e.position.set(230,150,80),e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048;return e.shadow.camera.left=-50,e.shadow.camera.right=50,e.shadow.camera.top=50,e.shadow.camera.bottom=-50,e.shadow.camera.far=3500,e.shadow.bias=-1e-4,e.visible=!0,e}A.add(j()),A.animate=function(e){z.applyQuaternion((new n.db).setFromAxisAngle(new n.ub(0,1,0),e/20))};var B,E;B=window.innerWidth,E=window.innerHeight;var O=new n.X(75,B/E,.1,1e4);O.listener=new n.c,O.add(O.listener),O.zoomState="out";var F=O.getFocalLength(),C=O.getFocalLength()+16;O.position.z=5;var q=new n.ub,R=0,D=0;function _(e,t){var o;return e.gltf.animations.forEach(e=>{e.name!==t||(o=e)}),null==o&&console.error("animation: "+t+" cannot be found!"),o}function H(e,t){t.mixer=e,t.anim={idle:e.clipAction(_(t,"Idle")),running:e.clipAction(_(t,"Running best")),runWithBow:e.clipAction(_(t,"Running with bow best")),runWithLegsOnly:e.clipAction(_(t,"Running legs only")),jumping:e.clipAction(_(t,"Jumping2")).setLoop(n.J),equipBow:e.clipAction(_(t,"Equip Bow")).setLoop(n.J),drawBow:e.clipAction(_(t,"Draw bow")).setLoop(n.J),fireBow:e.clipAction(_(t,"Fire bow")).setLoop(n.J),death:e.clipAction(_(t,"death")).setLoop(n.J)},t.anim.drawBow.clampWhenFinished=!0,t.toggleBow=function(e){t.gltf.scene.children[0].children[1].visible=!e,t.gltf.scene.children[0].children[2].visible=e},t.isRunning=function(){return!!t.activeMovement&&t.activeMovement.toLowerCase().includes("run")},t.isFiring=function(){return t.bowState&&("drawn"==t.bowState||"drawing"==t.bowState||"firing"==t.bowState)},t.getPosition=function(){if(t.gltf)return t.gltf.scene.position.clone();console.error("archer.gltf has not been defined yet")},t.setPosition=function(e){null!=t.gltf?t.gltf.scene.position.copy(e):console.error("archer.gltf has not been defined yet")},t.getRotation=function(){if(t.gltf)return t.gltf.scene.rotation;console.error("archer.gltf has not been defined yet")},t.globalVector=function(e){return e.clone().applyEuler(this.getRotation())}}function I(e){var t=document.createTextNode(e),o=document.createElement("p");o.className="message",o.appendChild(t),document.getElementById("chat").appendChild(o)}O.nextPosition=function(e){if(null!=ze){var t=new n.ub;return t.x=e*Math.sin(R*Math.PI/360)*Math.cos(D*Math.PI/360),t.y=e*Math.sin(D*Math.PI/360),t.z=e*Math.cos(R*Math.PI/360)*Math.cos(D*Math.PI/360),q.clone().add(t.applyQuaternion((new n.db).setFromUnitVectors(new n.ub(0,1,0),q.clone().normalize())))}},O.zoomIn=function(){O.zoomState="zooming in"},O.zoomOut=function(){O.zoomState="zooming out"},O.resetFocalLength=function(){F=O.getFocalLength(),C=O.getFocalLength()+16},O.resetFocalLength(),O.animate=function(e){if("zooming in"==O.zoomState){if(O.getFocalLength()<C){var t=60;ze.doubleJumped&&(t/=2),(o=O.getFocalLength()+e*t)<C?O.setFocalLength(o):(O.setFocalLength(C),O.zoomState="in")}}else if("zooming out"==O.zoomState){var o;if(O.getFocalLength()>F)(o=O.getFocalLength()-60*e)>F?O.setFocalLength(o):(O.setFocalLength(F),O.zoomState="out")}},O.setPosition=function(e){O.position.copy(e)},O.updateCamera=function(){if(null!=ze){var e=ze.getPosition().sub(O.position.clone()),t=ze.getPosition().normalize().cross(e).normalize().multiplyScalar(-.5);q.copy(ze.getPosition().add(t).add(ze.getPosition().normalize().multiplyScalar(1.8)));var o=O.nextPosition(3.5),i=new n.hb(q,o.clone().sub(q).normalize(),0,3.5).intersectObjects(S,!0);i.length>0&&(o=i[0].point.clone().sub(o.clone().sub(i[0].point).normalize().multiplyScalar(.1))),O.setPosition(o)}O.up.copy(ze.getPosition().normalize()),O.lookAt(q),O.updateMatrix()},O.moveCamera=function(e,t){R-=.2*e;var o=D+.2*t;140>o&&o>-145&&(D=o),O.updateCamera()};const W=new WebSocket("wss://ws.bowdown.io:18181");function J(e){1==W.readyState?W.send(JSON.stringify(e)):console.error("error connecting to server")}W.onmessage=function(e){var t,o,i;if((e=JSON.parse(e.data)).players&&U.init(e.players),e.player){var a=e.player;a==ze.uuid?e.damage?ze.takeDamage(e.damage):e.kills&&Ve(e.kills):e.chatMessage?I(e.chatMessage):"disconnected"===e.status?(A.remove(U.get(a).gltf.scene),U.get(a)):U.get(a)?U.get(a).gltf&&e.position&&null!=e.rotation?U.move(a,e.position,e.rotation):U.get(a).gltf&&e.playAction?U.playAction(a,e.playAction):U.get(a).gltf&&e.stopAction&&U.stopAction(a,e.stopAction):U.add(a,e.position,e.race)}else e.arrow&&(e.arrow.stopped?(i=e.arrow,te[i.uuid].position.copy(i.position),te[i.uuid].stopped=!0):(t=e.arrow,(o=ce(t.origin,t.rotation,t.type)).uuid=t.uuid,o.player=t.player,o.velocity=new n.ub(t.velocity.x,t.velocity.y,t.velocity.z),te[o.uuid]=o,se(o,(Date.now()-t.timeOfShoot)/1e3)))};o(5);var U={},T={},X=[];U.all=function(){return T},U.get=e=>T[e],U.add=function(e,t,o){T[e]={},null==o&&(console.error("race is undefined"),o="brown"),r.load("./models/benji_"+o+".gltf",function(o){T[e].gltf=o,H(new n.b(o.scene),T[e]),t&&U.move(e,t,0),A.add(o.scene);var i=new n.N(new n.g(.5,2,.5));i.position.y+=1,i.material.visible=!1,o.scene.add(i),i.playerUuid=e,X.push(i)})},U.init=function(e){Object.keys(e).forEach(t=>{U.add(t,e[t].position,e[t].race)})},U.move=function(e,t,o){var n=T[e];n.gltf.scene.position.copy(t),n.gltf.scene.rotation.copy(o)},U.playAction=function(e,t){T[e].anim[t].reset().play()},U.stopAction=function(e,t){T[e].anim[t].stop()};var V=new n.d;function Y(e){var t=new n.bb(O.listener);return V.load(e,function(e){t.setBuffer(e),t.setRefDistance(5)}),t}var N=o(24),G=o.n(N),Q=o(25),K=o.n(Q),Z=o(26),$=o.n(Z),ee=[],te=[],oe=.06,ne=.75;const ie=new n.ub(0,1.5,0),ae={normal:{color:65280},rope:{color:16743168}};new n.d;var re={};function ce(e,t,o){ae[o]||console.error("arrow type: "+o+" does not exist");var i=new n.g(oe,oe,ne),a=new n.O({color:ae[o].color}),r=new n.N(i,a);return"rope"==o?r.add(re.grappleHit):r.add(re.arrowHitGround),r.add(re.arrowHitPlayer),r.origin=e,r.position.copy(e),r.rotation.copy(t),A.add(r),r.type=o,r}function le(e){var t=ze.getPosition().add(de()),o=ce(t,O.rotation,e);o.uuid=c(),o.playerUuid=ze.uuid;var i=new n.hb;i.setFromCamera({x:0,y:0},O);var a,r=i.intersectObjects(S.concat(X),!0);return r.length>0?a=r[0].point.sub(t):(a=new n.ub,O.getWorldDirection(a)),o.velocity=a.normalize().multiplyScalar(60),ee.push(o),J({arrow:{type:e,origin:o.position,uuid:o.uuid,player:ze.uuid,rotation:o.rotation,velocity:o.velocity,timeOfShoot:Date.now()}}),o}function se(e,t){e.velocity.sub(e.position.clone().normalize().multiplyScalar(9*t)),e.position.add(e.velocity.clone().multiplyScalar(t))}function ue(e){ee.forEach(t=>{if("rope"==t.type){t.rope&&A.remove(t.rope);var o=new n.s,i=new n.B({color:16775912,linewidth:10});o.vertices.push(ze.getPosition().add(de()),t.position);var a=new n.A(o,i);t.rope=a,A.add(a)}if(!t.stopped){se(t,e);var r=new n.ub(0,0,1);r.applyEuler(t.rotation).normalize();var c=t.position.clone().sub(t.origin).length()/2,l=new n.hb(t.position,r,0,c),s=l.intersectObjects(X);if(s.length>0){var u=s.pop();t.position.copy(u.point),re.arrowHitPlayer.play(),t.stopped=!0,function(e){J({player:e,damage:100})}(u.object.playerUuid)}(s=l.intersectObjects(S,!0)).length>0&&(t.position.copy(s.pop().point),"rope"==t.type?re.grappleHit.play():re.arrowHitGround.play(),t.stopped=!0,J({arrow:{stopped:!0,position:t.position,uuid:t.uuid}}))}}),Object.keys(te).forEach(t=>{te[t].stopped||se(te[t],e)})}function de(){return ze.globalVector(ie)}re.arrowHitGround=Y(G.a),re.arrowHitPlayer=Y(K.a),re.grappleHit=Y($.a);var pe=o(27),me=o.n(pe),ge=o(28),we=o.n(ge),he=o(29),fe=o.n(he),ye=o(30),be=o.n(ye);const ve=o(5);var xe={uuid:c()};const ke=7,Ae=1.3,Se=15,Le=new n.ub(230,150,80).multiplyScalar(.75);var Me={};Me.bowShot=Y(me.a),Me.bowDraw=Y(we.a),Me.grappleShot=Y(fe.a),Me.grappleReel=Y(be.a),xe.race=["black","brown","white"][Math.floor(3*Math.random())],r.load(ve("./benji_"+xe.race+".gltf"),e=>{xe.gltf=e,Object.keys(Me).forEach(e=>xe.gltf.scene.add(Me[e])),xe.velocity=new n.ub,xe.bowState="unequipped";var t=new n.b(e.scene);H(t,xe),t.addEventListener("finished",e=>{"Draw bow"==e.action.getClip().name?xe.bowState="drawn":"death"==e.action.getClip().name?A.remove(xe.gltf.scene):("Fire bow"==e.action.getClip().name&&(xe.bowState="equipped"),xe.idle())}),xe.falling=function(e){if(e){var t=xe.getPosition().add(xe.velocity.clone().multiplyScalar(e)).sub(this.globalVector(new n.ub(0,.1,0))),o=this.globalVector(new n.ub(0,1,0));return!(new n.hb(t,o,0,.2+xe.velocity.length()*e).intersectObjects(S,!0).length>0)||(xe.doubleJumped=!1,!1)}};var o;function i(e,t,o,n){return e.clone().projectOnPlane(xe.getPosition().normalize()).applyAxisAngle(xe.getPosition().normalize(),-Math.atan2(t.x,t.y)).normalize().multiplyScalar(n*function(e){return e.keyboard.shift?(xe.isRunning()&&(xe.anim[xe.activeMovement].timeScale=Ae),ke*Ae):(xe.anim[xe.activeMovement]&&(xe.anim[xe.activeMovement].timeScale=1),ke)}(o))}function a(e,t){var o,i;i=e?e.clone().normalize():xe.getPosition().normalize(),t?(xe.getRotation().copy(new n.p(0,t,0)),o=(new n.db).setFromUnitVectors(new n.ub(0,1,0),i)):e&&(o=(new n.db).setFromUnitVectors(xe.getPosition().normalize(),i)),o&&xe.gltf.scene.applyQuaternion(o)}xe.collisionDetected=function(e){var t;t=xe,l&&t.gltf.scene.children.forEach(e=>{"collision line"===e.name&&t.gltf.scene.remove(e)});var o=e.clone().sub(xe.getPosition()),i=new n.hb(xe.getPosition(),o.clone().normalize(),0,o.length()).intersectObjects(S,!0);return i.length>0?o:(i=new n.hb(xe.getPosition().add(this.globalVector(new n.ub(0,1,0))),o.clone().normalize(),0,o.length()).intersectObjects(S,!0)).length>0&&o},xe.playBowAction=function(e){xe.isRunning()&&"runWithLegsOnly"!=xe.activeMovement?xe.movementAction("runWithLegsOnly"):xe.activeMovement&&(xe.stopAction(xe.activeMovement),xe.activeMovement=null),xe.bowAction(e),xe.broadcast()},xe.onMouseDown=function(){null!=o?(o=null,ee.forEach(e=>{"rope"==e.type&&(e.type=null,A.remove(e.rope))}),Me.grappleReel.isPlaying&&Me.grappleReel.stop()):"unequipped"==xe.bowState?xe.equipBow():(this.activeActions.includes("jumping")&&this.stopAction("jumping"),Me.bowDraw.play(),xe.playBowAction("drawBow"),xe.bowState="drawing",setTimeout(function(){"drawing"==xe.bowState&&(document.getElementById("crosshair").classList.add("aiming"),xe.bowState="drawn")},1e3),O.zoomIn())},xe.onMouseUp=function(e){document.getElementById("crosshair").classList.remove("aiming"),Me.bowDraw.isPlaying&&Me.bowDraw.stop(),"drawn"==xe.bowState?(xe.playBowAction("fireBow"),2==e.button?(o=le("rope"),Me.grappleShot.play()):(Me.bowShot.play(),le("normal")),xe.bowState="firing",O.zoomOut()):"drawing"===xe.bowState&&(xe.stopAction(xe.activeBowAction),xe.activeBowAction=null,xe.bowState="equipped",xe.idle(),O.zoomOut())},xe.broadcast=async function(){J({player:xe.uuid,position:xe.getPosition(),rotation:xe.getRotation(),bowState:xe.bowState})},xe.doubleJumped=!1,xe.animate=function(e,t){var r,c,l=function(e){var t=0,o=0;if(0!=e.touch.x&&0!=e.touch.y){var i=new n.tb(e.touch.x,e.touch.y);i.length()>100?e.keyboard.shift=!0:e.keyboard.shift=!1,i.normalize(),t=i.x,o=i.y}return e.keyboard.forward&&(t+=0,o+=1),e.keyboard.backward&&(t+=0,o+=-1),e.keyboard.left&&(t+=-1,o+=0),e.keyboard.right&&(t+=1,o+=0),new n.tb(t,o)}(t),s=O.getWorldDirection(new n.ub),u=i(s,l,t,e),d=function(e){var t=e.clone();return t.applyQuaternion((new n.db).setFromUnitVectors(q.clone().normalize(),new n.ub(0,1,0))),new n.tb(t.x,t.z)}(s),p=function(e,t,o){return 0==t.length()&&(t=new n.tb(0,1)),e.clone().rotateAround(new n.tb,Math.atan2(t.x,t.y))}(d,l),m=xe.falling(e);if(!m&&A.loaded)if(0!=t.touch.x&&0!=t.touch.y||t.keyboard.forward||t.keyboard.backward||t.keyboard.left||t.keyboard.right){c=Math.atan2(p.x,p.y),xe.velocity.set(0,0,0),(r=xe.getPosition()).add(u);var g=r.clone().add(this.globalVector(new n.ub(0,.5,0))),w=new n.hb(g,this.globalVector(new n.ub(0,-1,0)),0,1).intersectObjects(S,!0);w.length>0&&(r=w[0].point.add(this.globalVector(new n.ub(0,.01,0)))),xe.isRunning()||("equipped"==xe.bowState?xe.movementAction("runWithBow"):xe.isFiring()?xe.movementAction("runWithLegsOnly"):xe.movementAction("running"))}else xe.isRunning()&&(xe.isFiring()?(xe.stopAction(xe.activeMovement),xe.activeMovement=null):xe.idle());else{var h=10;xe.doubleJumped&&xe.isFiring()&&(h=5),xe.velocity.sub(xe.getPosition().normalize().multiplyScalar(h*e))}if(xe.isFiring()&&(c=Math.atan2(d.x,d.y),O.updateCamera(),xe.broadcast()),t.jump&&!xe.doubleJumped&&(t.jump=null,m&&(xe.doubleJumped=!0),l.length()&&this.velocity.copy(u.clone().multiplyScalar(1/e)),this.velocity.add(this.getPosition().normalize().multiplyScalar(7)),this.playAction("jumping")),function(e,t,n){if(0!=xe.velocity.length()){if(null!=o&&o.stopped){if(0!=t.length()){var i=n.clone().applyAxisAngle(xe.getPosition().normalize(),-Math.atan2(t.x,t.y));xe.velocity.add(i.multiplyScalar(Se*e))}var a=o.position.clone().sub(xe.getPosition());xe.velocity.add(a.normalize().multiplyScalar(Se*e)),xe.velocity.angleTo(a)>Math.PI/2&&xe.velocity.projectOnPlane(a.clone().normalize()),Me.grappleReel.isPlaying||Me.grappleReel.play()}return xe.velocity.clone().multiplyScalar(e)}}(e,l,s)&&(r||(r=xe.getPosition()),r.add(xe.velocity.clone().multiplyScalar(e))),r){var f=xe.collisionDetected(r);f?m?(xe.velocity.copy(f.clone().negate().normalize().multiplyScalar(10)),r.add(xe.velocity.clone().multiplyScalar(e)),xe.setPosition(r)):xe.velocity.set(0,0,0):function(e,t){a(e,t),xe.setPosition(e),O.updateCamera()}(r,c),xe.broadcast()}else c&&a(r,c)},xe.idle=function(){xe.movementAction("idle"),xe.broadcast()},xe.equipBow=function(){xe.bowState="equipped",xe.playBowAction("equipBow"),xe.toggleBow(!0)},xe.unequipBow=function(){xe.toggleBow(!1),xe.bowState="unequipped"},xe.takeDamage=function(){this.playAction("death"),Ye()},xe.respawn=function(){A.add(xe.gltf.scene),xe.setPosition(Le)},xe.sendChat=function(e){J({player:xe.uuid,chatMessage:e})},xe.activeActions=[],xe.playAction=function(e){this.anim[e]&&(this.anim[e].reset().play(),J({player:this.uuid,playAction:e}),this.activeActions.includes(e)||this.activeActions.push(e))},xe.stopAction=function(e){this.activeActions.includes(e)?(this.activeActions=this.activeActions.filter(t=>t!=e),this.anim[e].stop(),J({player:this.uuid,stopAction:e})):console.error("tried to stop action: "+e+", but action was never started")},xe.bowAction=function(e){this.anim&&this.anim[e]?this.activeBowAction!=e&&(this.activeBowAction&&(this.stopAction(this.activeBowAction),this.activeBowAction=null),this.activeMovement&&"runWithLegsOnly"!=this.activeMovement&&this.stopAction(this.activeMovement),e&&this.playAction(e),this.activeBowAction=e):console.error("action: "+e+" does not exist!")},xe.movementAction=function(e="idle"){if(this.anim&&this.anim[e]){if(this.activeMovement){if(this.activeMovement==e)return;this.stopAction(this.activeMovement)}this.playAction(e),this.activeMovement=e}else console.error("action: "+e+" does not exist!")},xe.setPosition(Le),xe.gltf.scene.applyQuaternion((new n.db).setFromUnitVectors(new n.ub(0,1,0),xe.getPosition().normalize())),A.add(xe.gltf.scene),J({player:xe.uuid,position:xe.getPosition(),race:xe.race}),xe.equipBow(),xe.idle()});var ze=xe,Pe=new n.xb({antialias:!0,alpha:!0});Pe.setClearColor("#e5e5e5"),Pe.setSize(window.innerWidth,window.innerHeight,!1),Pe.setPixelRatio(window.devicePixelRatio),Pe.gammaOutput=!0,Pe.gammaFactor=2.2,o.d(t,"start",function(){return $e}),o.d(t,"gameOver",function(){return Ye}),o.d(t,"setKillCount",function(){return Ve}),o(31);var je=new n.k;window.addEventListener("resize",function(){var e,t;e=window.innerWidth,t=window.innerHeight,_e&&window.innerWidth>window.innerHeight?(_e=!1,document.body.classList.remove("rotated")):_e&&(e=window.innerHeight,t=window.innerWidth);Pe.setSize(e,t,!1),O.aspect=e/t,O.resetFocalLength(),O.updateProjectionMatrix()});var Be={keyboard:{forward:!1,backward:!1,left:!1,right:!1,space:!1},touch:{x:0,y:0}},Ee="playing",Oe=!1,Fe={id:null,x:null,y:null,shoot:!1},Ce={id:null,x:null,y:null},qe={id:null};const Re=4,De=[document.getElementById("shoot-button"),document.getElementById("rope-button"),document.getElementById("jump-button")];var _e;function He(){requestAnimationFrame(He);var e=je.getDelta();ze&&ze.mixer&&("gameOver"!=Ee&&ze.animate(e,Be),ze.mixer.update(e)),ue(e),Object.keys(U.all()).length&&function(e){Object.keys(T).forEach(t=>{T[t].mixer&&T[t].mixer.update(e)})}(e),O.animate(e),A.animate(e),Pe.render(A,O)}function Ie(e,t){if("string"==typeof e.key)switch(e.key.toLowerCase()){case"w":Be.keyboard.forward=t;break;case"a":Be.keyboard.left=t;break;case"s":Be.keyboard.backward=t;break;case"d":Be.keyboard.right=t;break;case" ":null!=Be.jump?Be.jump=t:t||(Be.jump=!1);break;case"shift":Be.keyboard.shift=t}}function We(e){if(13===e.keyCode&&document.getElementById("chat").classList.contains("chatting")){var t=document.getElementById("chat-text-box");ze.sendChat(t.value),I(t.value),t.value="",document.getElementById("chat").classList.remove("chatting")}Ie(e,!0)}function Je(e){Ie(e,!1)}function Ue(){"chat"==event.target.id||"chat"==event.target.parentElement.id?document.getElementById("chat").classList.add("chatting"):(document.getElementById("chat").classList.remove("chatting"),2!=event.button&&"paused"==Ee&&(document.body.requestPointerLock&&document.body.requestPointerLock(),Xe()),"playing"==Ee&&ze.onMouseDown())}function Te(e){"playing"===Ee&&ze.onMouseUp(e)}function Xe(){document.body.classList.remove("ready"),document.body.classList.add("playing"),Ee="playing"}function Ve(e){e,document.getElementById("kill-count").innerHTML+="X"}function Ye(){Ee="gameOver",document.body.classList.remove("playing"),document.getElementById("title").innerHTML="Game over",document.body.classList.remove("playing"),document.body.classList.add("gameOver")}function Ne(){Ee=document.pointerLockElement?"playing":"paused"}function Ge(e){e!=Oe&&(e?De.forEach(e=>e.setAttribute("style","display: block;")):De.forEach(e=>e.setAttribute("style","display: none;")),Oe=e)}function Qe(e){var t,o,n;e.preventDefault(),Ge(!0);for(var i=0;i<e.targetTouches.length;i++)e.targetTouches.item(i).identifier==Fe.id?t=e.targetTouches.item(i):e.targetTouches.item(i).identifier==Ce.id?o=e.targetTouches.item(i):null==n&&(n=e.targetTouches.item(i));t?(_e?O.moveCamera(Re*(t.pageY-Fe.y),-1*Re*(t.pageX-Fe.x)):O.moveCamera(Re*(t.pageX-Fe.x),Re*(t.pageY-Fe.y)),Fe.x=t.pageX,Fe.y=t.pageY):n&&("shoot-button"===n.target.id?(ze.onMouseDown(),Fe.shoot=!0):"rope-button"===n.target.id&&(ze.onMouseDown(),Fe.rope=!0),"jump-button"===n.target.id&&(Be.jump=!0,qe.id=n.identifier),(_e&&n.pageY>window.innerHeight/2||!_e&&n.pageX>window.innerWidth/2)&&(Fe.id=n.identifier,Fe.x=n.pageX,Fe.y=n.pageY)),o?_e?(Be.touch.y=o.pageX-Ce.x,Be.touch.x=o.pageY-Ce.y):(Be.touch.x=o.pageX-Ce.x,Be.touch.y=-1*(o.pageY-Ce.y)):n&&(_e&&n.pageY<window.innerHeight/2||!_e&&n.pageX<window.innerWidth/2)&&(Ce.id=n.identifier,Ce.x=n.pageX,Ce.y=n.pageY)}function Ke(e){Fe.id==e.changedTouches[0].identifier?(Fe.id==qe.id&&(Be.jump=!1),Fe.shoot&&ze.onMouseUp({button:0}),Fe.rope&&ze.onMouseUp({button:2}),Fe.id=null,Fe.shoot=!1,Fe.rope=!1):Ce.id==e.changedTouches[0].identifier&&(Ce.id=null,Be.touch={x:0,y:0})}function Ze(e){"shoot-button"!=e.target.id&&"jump-button"!=e.target.id&&"rope-button"!=e.target.id&&Ge(!1);var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,o=e.movementY||e.mozMovementY||e.webkitMovementY||0;O.moveCamera(t,o)}function $e(){document.addEventListener("mousemove",Ze),document.addEventListener("keydown",We),document.addEventListener("keyup",Je),document.addEventListener("mousedown",Ue),document.addEventListener("mouseup",Te),document.addEventListener("pointerlockchange",Ne),document.addEventListener("touchstart",Qe),document.addEventListener("touchmove",Qe),document.addEventListener("touchend",Ke),document.body.appendChild(Pe.domElement),De.concat(Pe.domElement).forEach(e=>new a.a.Manager(e,{recognizers:[[a.a.Pinch,{enable:!0}]]})),window.innerWidth<window.innerHeight&&document.body.requestPointerLock&&document.body.requestPointerLock()&&screen.orientation.type&&screen.orientation.type.includes("portrait")&&(document.body.requestFullscreen?document.body.requestFullscreen():document.body.mozRequestFullScreen?document.body.mozRequestFullScreen():document.body.webkitRequestFullscreen?document.body.webkitRequestFullscreen():document.body.msRequestFullscreen&&document.body.msRequestFullscreen(),document.body.classList.add("rotated"),_e=!0),He(),Xe()}Be.jump=0,document.getElementById("respawn").onclick=function(){ze.respawn(),Xe()}},,function(e,t,o){e.exports=o.p+"models/lowild.glb"},function(e,t,o){var n={"./Characters_Black.png":14,"./Characters_Brown.png":15,"./Characters_White.png":16,"./battle_planet.glb":17,"./benji.bin":18,"./benji.gltf":19,"./benji_black.gltf":20,"./benji_brown.gltf":21,"./benji_white.gltf":22,"./env.glb":23,"./lowild.glb":4};function i(e){var t=a(e);return o(t)}function a(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=a,e.exports=i,i.id=5},,,function(e,t,o){e.exports=o.p+"skybox/yellowcloud_ft.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_bk.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_up.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_dn.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_rt.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_lf.jpg"},function(e,t,o){e.exports=o.p+"models/Characters_Black.png"},function(e,t,o){e.exports=o.p+"models/Characters_Brown.png"},function(e,t,o){e.exports=o.p+"models/Characters_White.png"},function(e,t,o){e.exports=o.p+"models/battle_planet.glb"},function(e,t,o){e.exports=o.p+"models/benji.bin"},function(e,t,o){e.exports=o.p+"models/benji.gltf"},function(e,t,o){e.exports=o.p+"models/benji_black.gltf"},function(e,t,o){e.exports=o.p+"models/benji_brown.gltf"},function(e,t,o){e.exports=o.p+"models/benji_white.gltf"},function(e,t,o){e.exports=o.p+"models/env.glb"},function(e,t,o){e.exports=o.p+"audio/effects/Arrow to Ground.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Arrow to Player.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Grapple Hit.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Bow Shot.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Bow Draw.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Grapple Shot.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Grapple Reel Loop.mp3"},function(e,t,o){var n={"./bow-and-arrow.svg":32,"./dot-and-circle.svg":33,"./fullscreen.svg":34,"./rope.svg":35};function i(e){var t=a(e);return o(t)}function a(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=a,e.exports=i,i.id=31},function(e,t,o){e.exports=o.p+"icons/bow-and-arrow.svg"},function(e,t,o){e.exports=o.p+"icons/dot-and-circle.svg"},function(e,t,o){e.exports=o.p+"icons/fullscreen.svg"},function(e,t,o){e.exports=o.p+"icons/rope.svg"}]]);