(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,function(e,n,t){"use strict";t.r(n);var o=t(2),i=new(t(4).a),a=t(5),c=t.n(a),r=t(6),s=t.n(r),d=t(7),u=t.n(d),l=t(8),p=t.n(l),w=t(9),m=t.n(w),b=t(10),f=t.n(b),v=t(11),y=t.n(v),h=new o.fb,g=[];i.load(c.a,function(e){var n=e.scene;n.position.y-=10,h.add(n),g.push(n)});let x=[];x.push(new o.M({map:(new o.lb).load(s.a)})),x.push(new o.M({map:(new o.lb).load(u.a)})),x.push(new o.M({map:(new o.lb).load(p.a)})),x.push(new o.M({map:(new o.lb).load(m.a)})),x.push(new o.M({map:(new o.lb).load(f.a)})),x.push(new o.M({map:(new o.lb).load(y.a)}));for(let e=0;e<6;e++)x[e].side=o.c;let k=new o.e(1e3,1e3,1e3),M=new o.L(k,x);var z;h.add(M),h.add(((z=new o.r(16777215,10209703)).color.setHSL(.6,1,.8),z.groundColor.setHSL(.095,1,.75),z.position.set(0,50,0),z.visible=!0,z)),h.add(function(){var e=new o.l(16777215,1);e.color.setHSL(.1,1,.95),e.position.set(-1,1.75,1),e.position.multiplyScalar(30),e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048;return e.shadow.camera.left=-50,e.shadow.camera.right=50,e.shadow.camera.top=50,e.shadow.camera.bottom=-50,e.shadow.camera.far=3500,e.shadow.bias=-1e-4,e.visible=!0,e}());var A=new o.tb({antialias:!0,alpha:!0});function S(e,n){var t;return e.forEach(e=>{e.name!==n||(t=e)}),t}function q(e,n){n.mixer=e,n.anim={idle:e.clipAction(S(n.animations,"Idle")),running:e.clipAction(S(n.animations,"Running2")),runWithBow:e.clipAction(S(n.animations,"Run with bow")),runWithLegsOnly:e.clipAction(S(n.animations,"Running legs only")),jumping:e.clipAction(S(n.animations,"Jumping")).setLoop(o.H),equipBow:e.clipAction(S(n.animations,"Equip Bow")).setLoop(o.H),drawBow:e.clipAction(S(n.animations,"Draw bow")).setLoop(o.H),fireBow:e.clipAction(S(n.animations,"Fire bow")).setLoop(o.H)},n.anim.drawBow.clampWhenFinished=!0,n.toggleBow=function(e){n.scene.children[0].children[1].visible=!e,n.scene.children[0].children[2].visible=e},n.bowAction=function(e){n.activeBowAction!=e&&(e&&n.anim[e].reset().play(),n.activeBowAction=e)},n.movementAction=function(e="idle"){if(n.anim&&n.anim[e]){if(n.activeMovement){if(n.activeMovement==e)return;n.anim[n.activeMovement].stop()}n.anim[e].reset().play(),n.activeMovement=e}else console.error("action: "+e+" does not exist!")},n.isRunning=function(){return!!n.activeMovement&&n.activeMovement.toLowerCase().includes("run")},n.isFiring=function(){return n.bowState&&("drawn"==n.bowState||"drawing"==n.bowState||"firing"==n.bowState)}}A.setClearColor("#e5e5e5"),A.setPixelRatio(window.devicePixelRatio),A.setSize(window.innerWidth,window.innerHeight),A.gammaOutput=!0,A.gammaFactor=2.2;var L=t(3),B=t.n(L);const E=new WebSocket("ws://ec2-18-191-136-250.us-east-2.compute.amazonaws.com:18181");function j(e){E.readyState&&E.send(JSON.stringify(e))}E.onopen=function(){j({message:"sup fucker"})},E.onmessage=function(e){var n,t;if((e=JSON.parse(e.data)).players&&O.init(e.players),e.player){var i=e.player;i==J?e.damage&&I.takeDamage(e.damage):O.get(i)?"disconnected"===e.status?(h.remove(O.get(i).scene),O.get(i)):O.get(i).scene&&null!=e.x&&null!=e.y&&null!=e.z&&null!=e.rotation&&O.move(i,new o.qb(e.x,e.y,e.z),e.rotation,e.movementAction,e.bowAction):O.add(i,new o.qb(e.x,e.y,e.z))}else e.arrow&&(n=e.arrow,(t=X(n.origin,n.rotation)).velocity=new o.qb(n.velocity.x,n.velocity.y,n.velocity.z),F.push(t),R(t,(Date.now()-n.timeOfShoot)/1e3))};var O={},W={},C=[];O.all=function(){return W},O.get=e=>W[e],O.add=function(e,n){W[e]="loading",i.load(B.a,function(t){W[e]=t,q(new o.b(t.scene),t),n&&O.move(e,n,0),h.add(t.scene);var i=new o.L(new o.e(.5,2,.5));i.position.y+=1,i.material.visible=!1,t.scene.add(i),i.playerUuid=e,C.push(i)})},O.init=function(e){Object.keys(e).forEach(n=>{O.add(n,new o.qb(e[n].x,e[n].y,e[n].z))})},O.move=function(e,n,t,o,i){var a=W[e];a.scene.position.copy(n),a.scene.rotation.y=t,o&&a.movementAction(o),i&&a.bowAction(i)};var D=[],F=[],P=.06,H=.75;function X(e,n){var t=new o.e(P,P,H),i=new o.M({color:65280}),a=new o.L(t,i);return a.origin=e,a.position.copy(e),a.rotation.copy(n),h.add(a),a}function R(e,n){e.velocity.y-=9*n,e.position.add(e.velocity.clone().multiplyScalar(n))}function Y(e){D.forEach(n=>{if(!n.stopped){R(n,e);var t=new o.qb(0,0,1);t.applyEuler(n.rotation).normalize();var i=n.position.clone().sub(n.origin).length()/2,a=new o.db(n.position,t,0,i),c=a.intersectObjects(C);if(c.length>0){var r=c.pop();n.position.copy(r.point),n.stopped=!0,function(e){j({player:e,damage:100})}(r.object.playerUuid)}(c=a.intersectObjects(g,!0)).length>0&&(n.position.copy(c.pop().point),n.stopped=!0)}}),F.forEach(n=>{R(n,e)})}var I,T,J="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)});const U=.12;i.load(B.a,e=>{(I=e).velocity=new o.qb,I.bowState="unequipped",h.add(e.scene),q(T=new o.b(e.scene),I),T.addEventListener("finished",e=>{"Draw bow"==e.action.getClip().name?I.bowState="drawn":("Fire bow"==e.action.getClip().name&&(I.bowState="equipped"),I.moveAction("idle"))}),I.falling=function(){var e=new o.qb(0,-1,0);e=e.clone().normalize();var n=new o.db(new o.qb(I.scene.position.x,I.scene.position.y+.9,I.scene.position.z),e).intersectObjects(g,!0);return!(n.length>0&&n[0].distance<=new o.y(new o.qb,e).distance())};I.collisionDetected=function(e){for(var n=-1;n<=1;n++)for(var t=-1;t<=1;t++){n*=.5,t*=.5;var i=new o.qb(n,1,t);i=i.clone().normalize();var a=new o.db(new o.qb(e.x,e.y,e.z),i).intersectObjects(g,!0);if(a.length>0&&a[0].distance<=new o.y(new o.qb,i).distance())return!0}return!1},I.moveAction=function(e){I.movementAction(e),I.broadcast()},I.playBowAction=function(e){I.isRunning()&&"runWithLegsOnly"!=I.activeMovement?I.moveAction("runWithLegsOnly"):I.activeMovement&&(I.anim[I.activeMovement].stop(),I.activeMovement=null),I.bowAction(e),I.broadcast()},I.jump=function(){I.velocity.y=5,I.moveAction("jumping")},I.onMouseDown=function(){"unequipped"==I.bowState?I.equipBow():(I.playBowAction("drawBow"),I.bowState="drawing",Z.zoomIn())},I.onMouseUp=function(){"drawn"==I.bowState?(I.playBowAction("fireBow"),I.anim.drawBow.stop(),function(){var e=I.scene.position.clone().add(new o.qb(0,1.5,0)),n=X(e,Z.rotation),t=new o.db;t.setFromCamera({x:0,y:0},Z);var i,a=t.intersectObjects(g.concat(C),!0);a.length>0?i=a[0].point.sub(e):(i=new o.qb,Z.getWorldDirection(i)),n.velocity=i.normalize().multiplyScalar(60),D.push(n),j({arrow:{origin:n.position,rotation:n.rotation,velocity:n.velocity,timeOfShoot:Date.now()}})}(),I.bowState="firing",Z.zoomOut()):"drawing"===I.bowState&&(I.anim.drawBow.stop(),I.bowAction(),I.bowState="equipped",I.moveAction("idle"),Z.zoomOut())},I.broadcast=async function(){j({player:J,x:I.scene.position.x,y:I.scene.position.y,z:I.scene.position.z,rotation:I.scene.rotation.y,movementAction:I.activeMovement,bowAction:I.activeBowAction,bowState:I.bowState})},I.move=function(e,n=I.scene.rotation.y){if(I.collisionDetected(e))I.velocity.set(0,0,0);else{if(I.scene.position.copy(e),I.isFiring()){var t=new o.qb;Z.getWorldDirection(t),n=Math.atan2(t.x,t.z)}I.scene.rotation.y=n,Z.updateCamera(),I.broadcast()}},I.animate=function(e,n){var t=new o.qb;if(I.falling())I.velocity.y-=10*e,t=I.scene.position.clone().add(I.velocity.clone().multiplyScalar(e)),I.move(t);else{I.velocity.set(0,0,0);var i=function(e){var n=new o.qb;Z.getWorldDirection(n),(n=new o.pb(n.x,n.z)).normalize().multiplyScalar(U);var t=0,i=0;if(0!=e.touch.x&&0!=e.touch.y){var a=new o.pb(e.touch.x,e.touch.y).normalize();t=a.x,i=a.y}return e.keyboard.forward&&(t+=0,i+=1),e.keyboard.backward&&(t+=0,i+=-1),e.keyboard.left&&(t+=-1,i+=0),e.keyboard.right&&(t+=1,i+=0),n.rotateAround(new o.pb,Math.atan2(t,i))}(n),a=Math.atan2(i.x,i.y);if(n.keyboard.space&&I.jump(),0!=n.touch.x&&0!=n.touch.y||n.keyboard.forward||n.keyboard.backward||n.keyboard.left||n.keyboard.right){t.z=I.scene.position.z+i.y,t.x=I.scene.position.x+i.x,I.velocity.x=(t.x-I.scene.position.x)/e,I.velocity.z=(t.z-I.scene.position.z)/e,t.y=I.scene.position.y;var c=new o.qb(t.x,t.y+1,t.z),r=new o.db(c,new o.qb(0,-1,0)).intersectObjects(g,!0);r.length>0&&(t.y=r[0].point.y+.01),I.move(t,a),I.isRunning()||("equipped"==I.bowState?I.moveAction("runWithBow"):I.isFiring()?I.moveAction("runWithLegsOnly"):I.moveAction("running"))}else if(I.isRunning()&&I.moveAction("idle"),I.isFiring()){i=new o.qb;Z.getWorldDirection(i),a=Math.atan2(i.x,i.z),I.scene.rotation.y=a,Z.updateCamera(),I.broadcast()}n.keyboard.space&&(t=I.scene.position.clone().add(I.velocity.clone().multiplyScalar(e)),I.move(t))}},I.equipBow=function(){I.bowState="equipped",I.playBowAction("equipBow"),I.toggleBow(!0)},I.unequipBow=function(){I.toggleBow(!1),I.bowState="unequipped"},I.takeDamage=function(){I.scene.position.y-=20},I.unequipBow(),I.moveAction("idle")});var Z=new o.V(75,window.innerWidth/window.innerHeight,.1,3e3);Z.defaultZoom=Z.getFocalLength(),Z.position.z=5;var N=new o.qb(0,1,0),V=0,G=0;Z.nextPosition=function(e){if(null!=I){var n=new o.qb;return n.x=N.x+e*Math.sin(V*Math.PI/360)*Math.cos(G*Math.PI/360),n.y=N.y+e*Math.sin(G*Math.PI/360),n.z=N.z+e*Math.cos(V*Math.PI/360)*Math.cos(G*Math.PI/360),n}},Z.zoomIn=function(){Z.setFocalLength(Z.defaultZoom+4)},Z.zoomOut=function(){Z.setFocalLength(Z.defaultZoom)},Z.setPosition=function(e){Z.position.copy(e)},Z.updateCamera=function(){if(null!=I){var e=I.scene.position.clone().sub(Z.position.clone()),n=new o.qb(-e.z,0,e.x).normalize();N.copy(I.scene.position.clone().add(n)).setY(I.scene.position.y+1);var t=Z.nextPosition(3.5),i=new o.db(N,t.clone().sub(N).normalize(),0,5).intersectObjects(g,!0);i.length>0&&(t=i[0].point.clone().sub(t.clone().sub(i[0].point).normalize().multiplyScalar(.1))),Z.setPosition(t)}Z.lookAt(N),Z.updateMatrix()},Z.moveCamera=function(e,n){V-=.2*e;var t=G+.2*n;135>=t&&t>=-80&&(G=t),Z.updateCamera()},t.d(n,"start",function(){return be});var K=new o.i;document.body.appendChild(A.domElement),window.addEventListener("resize",function(){A.setSize(window.innerWidth,window.innerHeight),Z.aspect=window.innerWidth/window.innerHeight,Z.updateProjectionMatrix()});var Q={keyboard:{forward:!1,backward:!1,left:!1,right:!1,space:!1},touch:{x:0,y:0}},$="ready",_=!1,ee={id:null,x:null,y:null,shoot:!1},ne={id:null,x:null,y:null};function te(){requestAnimationFrame(te);var e=K.getDelta();Y(e),I&&T&&(I.animate(e,Q),T.update(e)),Object.keys(O.all()).length&&function(e){Object.keys(W).forEach(n=>{W[n].mixer&&W[n].mixer.update(e)})}(e),A.render(h,Z)}function oe(e,n){switch(e.key){case"w":Q.keyboard.forward=n;break;case"a":Q.keyboard.left=n;break;case"s":Q.keyboard.backward=n;break;case"d":Q.keyboard.right=n;break;case" ":Q.keyboard.space=n}}function ie(e){oe(e,!0)}function ae(e){oe(e,!1)}function ce(){"playing"===$&&I.onMouseDown()}function re(){"playing"===$&&I.onMouseUp()}function se(){"playing"!==$&&(document.body.requestPointerLock(),$="playing")}function de(){document.pointerLockElement||($="ready")}function ue(e){e!=_&&(e?shootButton.setAttribute("style","display: block;"+me):shootButton.setAttribute("style","display: none;"+me),_=e)}function le(e){var n,t,o;e.preventDefault(),ue(!0);for(var i=0;i<e.targetTouches.length;i++)e.targetTouches.item(i).identifier==ee.id?n=e.targetTouches.item(i):e.targetTouches.item(i).identifier==ne.id?t=e.targetTouches.item(i):null==o&&(o=e.targetTouches.item(i));n?(Z.moveCamera(4*(n.pageX-ee.x),4*(n.pageY-ee.y)),ee.x=n.pageX,ee.y=n.pageY):o&&("shootButton"===o.target.id&&(I.onMouseDown(),ee.shoot=!0),o.pageX>window.innerWidth/2&&(ee.id=o.identifier,ee.x=o.pageX,ee.y=o.pageY)),t?(Q.touch.x=t.pageX-ne.x,Q.touch.y=-1*(t.pageY-ne.y)):o&&o.pageX<window.innerWidth/2&&(ne.id=o.identifier,ne.x=o.pageX,ne.y=o.pageY)}function pe(e){ee.id==e.changedTouches[0].identifier?(ee.shoot&&I.onMouseUp(),ee.id=null,ee.shoot=!1):ne.id==e.changedTouches[0].identifier&&(ne.id=null,Q.touch={x:0,y:0})}function we(e){"shootButton"!=e.target.id&&ue(!1);var n=e.movementX||e.mozMovementX||e.webkitMovementX||0,t=e.movementY||e.mozMovementY||e.webkitMovementY||0;Z.moveCamera(n,t)}const me="position: fixed; top: 50%; left: 85%; width: 50px; height: 50px; background-image: url(dot-and-circle.svg);";function be(){document.addEventListener("mousemove",we),document.addEventListener("keydown",ie),document.addEventListener("keyup",ae),document.addEventListener("click",se),document.addEventListener("mousedown",ce),document.addEventListener("mouseup",re),document.addEventListener("pointerlockchange",de),document.addEventListener("touchstart",le),document.addEventListener("touchmove",le),document.addEventListener("touchend",pe),te();var e=document.createElement("div");e.setAttribute("style","position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 30px; height: 30px; background-image: url(crosshair.svg);"),document.body.appendChild(e);var n=document.createElement("div");n.setAttribute("id","shootButton"),n.setAttribute("style","display: none;"+me),document.body.appendChild(n)}},,function(e,n,t){e.exports=t.p+"aaa61a2e8305b0eb326a110017161ff0.glb"},,function(e,n,t){e.exports=t.p+"baae041779d88e3f44e7b73d83d4b782.glb"},function(e,n,t){e.exports=t.p+"7892e5f13382f146373e2feee6999074.jpg"},function(e,n,t){e.exports=t.p+"bfbf6e3b2e9c92cee83c5cb73c602dff.jpg"},function(e,n,t){e.exports=t.p+"f900c2f67538e778beaa220d765ddb86.jpg"},function(e,n,t){e.exports=t.p+"dd72bb23dae86654c0018bf2164773ea.jpg"},function(e,n,t){e.exports=t.p+"40cb740f2b07e44047f4ca7823a46d21.jpg"},function(e,n,t){e.exports=t.p+"cf70fe3d246583aa691b7ff3fde1d03b.jpg"}]]);