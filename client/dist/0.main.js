(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,function(e,t,o){"use strict";o.r(t);var n=o(3),i=o(6),a=o.n(i),r=new(o(7).a);function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}const l=!1;function s(e,t){if(l){var o=new n.s;o.vertices.push(t,new n.ub);var i=new n.B({color:16711680}),a=new n.A(o,i);a.name="collision line",e.gltf.scene.add(a)}}var u=o(4),d=o.n(u),p=o(8),m=o.n(p),g=o(9),w=o.n(g),h=o(10),f=o.n(h),b=o(11),y=o.n(b),v=o(12),x=o.n(v),k=o(13),A=o.n(k),S=new n.jb;S.loaded=!1;var L=[];r.load(d.a,function(e){var t=e.scene;t.position.y-=10,S.add(t),L.push(t),S.loaded=!0});let M=[];M.push(new n.O({map:(new n.pb).load(m.a)})),M.push(new n.O({map:(new n.pb).load(w.a)})),M.push(new n.O({map:(new n.pb).load(f.a)})),M.push(new n.O({map:(new n.pb).load(y.a)})),M.push(new n.O({map:(new n.pb).load(x.a)})),M.push(new n.O({map:(new n.pb).load(A.a)}));for(let e=0;e<6;e++)M[e].side=n.e;let z=new n.g(5e3,5e3,5e3),P=new n.N(z,M);var j;S.add(P),S.add(((j=new n.u(16777215,10209703)).color.setHSL(.6,1,.8),j.groundColor.setHSL(.095,1,.75),j.position.set(-690,-450,-240),j.visible=!0,j));B();function B(){var e=new n.n(16777215,3);e.color.setHSL(.1,1,.95),e.position.set(230,150,80),e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048;return e.shadow.camera.left=-50,e.shadow.camera.right=50,e.shadow.camera.top=50,e.shadow.camera.bottom=-50,e.shadow.camera.far=3500,e.shadow.bias=-1e-4,e.visible=!0,e}S.add(B()),S.animate=function(e){P.applyQuaternion((new n.db).setFromAxisAngle(new n.ub(0,1,0),e/20))};var O,E;O=window.innerWidth,E=window.innerHeight;var F=new n.X(75,O/E,.1,1e4);F.listener=new n.c,F.add(F.listener),F.zoomState="out";var C=F.getFocalLength(),q=F.getFocalLength()+16;F.position.z=5;var R=new n.ub,_=0,D=0;function H(e,t){var o;return e.gltf.animations.forEach(e=>{e.name!==t||(o=e)}),null==o&&console.error("animation: "+t+" cannot be found!"),o}function W(e,t){t.mixer=e,t.anim={idle:e.clipAction(H(t,"Idle")),running:e.clipAction(H(t,"Running best")),runWithBow:e.clipAction(H(t,"Running with bow best")),runWithLegsOnly:e.clipAction(H(t,"Running legs only")),jumping:e.clipAction(H(t,"Jumping2")).setLoop(n.J),equipBow:e.clipAction(H(t,"Equip Bow")).setLoop(n.J),drawBow:e.clipAction(H(t,"Draw bow")).setLoop(n.J),fireBow:e.clipAction(H(t,"Fire bow")).setLoop(n.J),death:e.clipAction(H(t,"death")).setLoop(n.J)},t.anim.drawBow.clampWhenFinished=!0,t.toggleBow=function(e){t.gltf.scene.children[0].children[1].visible=!e,t.gltf.scene.children[0].children[2].visible=e},t.isRunning=function(){return!!t.activeMovement&&t.activeMovement.toLowerCase().includes("run")},t.isFiring=function(){return t.bowState&&("drawn"==t.bowState||"drawing"==t.bowState||"firing"==t.bowState)},t.getPosition=function(){if(t.gltf)return t.gltf.scene.position.clone();console.error("archer.gltf has not been defined yet")},t.setPosition=function(e){null!=t.gltf?t.gltf.scene.position.copy(e):console.error("archer.gltf has not been defined yet")},t.getRotation=function(){if(t.gltf)return t.gltf.scene.rotation;console.error("archer.gltf has not been defined yet")},t.globalVector=function(e){return e.clone().applyEuler(this.getRotation())}}F.nextPosition=function(e){if(null!=Me){var t=new n.ub;return t.x=e*Math.sin(_*Math.PI/360)*Math.cos(D*Math.PI/360),t.y=e*Math.sin(D*Math.PI/360),t.z=e*Math.cos(_*Math.PI/360)*Math.cos(D*Math.PI/360),R.clone().add(t.applyQuaternion((new n.db).setFromUnitVectors(new n.ub(0,1,0),R.clone().normalize())))}},F.zoomIn=function(){F.zoomState="zooming in"},F.zoomOut=function(){F.zoomState="zooming out"},F.resetFocalLength=function(){C=F.getFocalLength(),q=F.getFocalLength()+16},F.resetFocalLength(),F.animate=function(e){if("zooming in"==F.zoomState){if(F.getFocalLength()<q){var t=60;Me.doubleJumped&&(t/=2),(o=F.getFocalLength()+e*t)<q?F.setFocalLength(o):(F.setFocalLength(q),F.zoomState="in")}}else if("zooming out"==F.zoomState){var o;if(F.getFocalLength()>C)(o=F.getFocalLength()-60*e)>C?F.setFocalLength(o):(F.setFocalLength(C),F.zoomState="out")}},F.setPosition=function(e){F.position.copy(e)},F.updateCamera=function(){if(null!=Me){var e=Me.getPosition().sub(F.position.clone()),t=Me.getPosition().normalize().cross(e).normalize().multiplyScalar(-.5);R.copy(Me.getPosition().add(t).add(Me.getPosition().normalize().multiplyScalar(1.8)));var o=F.nextPosition(3.5),i=new n.hb(R,o.clone().sub(R).normalize(),0,3.5).intersectObjects(L,!0);i.length>0&&(o=i[0].point.clone().sub(o.clone().sub(i[0].point).normalize().multiplyScalar(.1))),F.setPosition(o)}F.up.copy(Me.getPosition().normalize()),F.lookAt(R),F.updateMatrix()},F.moveCamera=function(e,t){_-=.2*e,D=D+.2*t,F.updateCamera()};const I=new WebSocket("wss://ws.bowdown.io:18181");function J(e){1==I.readyState?I.send(JSON.stringify(e)):console.error("error connecting to server")}I.onmessage=function(e){var t,o,i;if((e=JSON.parse(e.data)).players&&U.init(e.players),e.player){var a=e.player;a==Me.uuid?e.damage?Me.takeDamage(e.damage):e.kills&&Te(e.kills):e.chatMessage?function(e){var t=document.createTextNode(e),o=document.createElement("p").appendChild(t);document.getElementById("chat").appendChild(o)}(e.chatMessage):"disconnected"===e.status?(S.remove(U.get(a).gltf.scene),U.get(a)):U.get(a)?U.get(a).gltf&&e.position&&null!=e.rotation?U.move(a,e.position,e.rotation):U.get(a).gltf&&e.playAction?U.playAction(a,e.playAction):U.get(a).gltf&&e.stopAction&&U.stopAction(a,e.stopAction):U.add(a,e.position,e.race)}else e.arrow&&(e.arrow.stopped?(i=e.arrow,te[i.uuid].position.copy(i.position),te[i.uuid].stopped=!0):(t=e.arrow,(o=ce(t.origin,t.rotation,t.type)).uuid=t.uuid,o.player=t.player,o.velocity=new n.ub(t.velocity.x,t.velocity.y,t.velocity.z),te[o.uuid]=o,se(o,(Date.now()-t.timeOfShoot)/1e3)))};o(5);var U={},X={},T=[];U.all=function(){return X},U.get=e=>X[e],U.add=function(e,t,o){X[e]={},null==o&&(console.error("race is undefined"),o="brown"),r.load("./models/benji_"+o+".gltf",function(o){X[e].gltf=o,W(new n.b(o.scene),X[e]),t&&U.move(e,t,0),S.add(o.scene);var i=new n.N(new n.g(.5,2,.5));i.position.y+=1,i.material.visible=!1,o.scene.add(i),i.playerUuid=e,T.push(i)})},U.init=function(e){Object.keys(e).forEach(t=>{U.add(t,e[t].position,e[t].race)})},U.move=function(e,t,o){var n=X[e];n.gltf.scene.position.copy(t),n.gltf.scene.rotation.copy(o)},U.playAction=function(e,t){X[e].anim[t].reset().play()},U.stopAction=function(e,t){X[e].anim[t].stop()};var V=new n.d;function Y(e){var t=new n.bb(F.listener);return V.load(e,function(e){t.setBuffer(e),t.setRefDistance(5)}),t}var N=o(23),G=o.n(N),Q=o(24),K=o.n(Q),Z=o(25),$=o.n(Z),ee=[],te=[],oe=.06,ne=.75;const ie=new n.ub(0,1.5,0),ae={normal:{color:65280},rope:{color:16743168}};new n.d;var re={};function ce(e,t,o){ae[o]||console.error("arrow type: "+o+" does not exist");var i=new n.g(oe,oe,ne),a=new n.O({color:ae[o].color}),r=new n.N(i,a);return"rope"==o?r.add(re.grappleHit):r.add(re.arrowHitGround),r.add(re.arrowHitPlayer),r.origin=e,r.position.copy(e),r.rotation.copy(t),S.add(r),r.type=o,r}function le(e){var t=Me.getPosition().add(de()),o=ce(t,F.rotation,e);o.uuid=c(),o.playerUuid=Me.uuid;var i=new n.hb;i.setFromCamera({x:0,y:0},F);var a,r=i.intersectObjects(L.concat(T),!0);return r.length>0?a=r[0].point.sub(t):(a=new n.ub,F.getWorldDirection(a)),o.velocity=a.normalize().multiplyScalar(60),ee.push(o),J({arrow:{type:e,origin:o.position,uuid:o.uuid,player:Me.uuid,rotation:o.rotation,velocity:o.velocity,timeOfShoot:Date.now()}}),o}function se(e,t){e.velocity.sub(e.position.clone().normalize().multiplyScalar(9*t)),e.position.add(e.velocity.clone().multiplyScalar(t))}function ue(e){ee.forEach(t=>{if("rope"==t.type){t.rope&&S.remove(t.rope);var o=new n.s,i=new n.B({color:16775912,linewidth:10});o.vertices.push(Me.getPosition().add(de()),t.position);var a=new n.A(o,i);t.rope=a,S.add(a)}if(!t.stopped){se(t,e);var r=new n.ub(0,0,1);r.applyEuler(t.rotation).normalize();var c=t.position.clone().sub(t.origin).length()/2,l=new n.hb(t.position,r,0,c),s=l.intersectObjects(T);if(s.length>0){var u=s.pop();t.position.copy(u.point),re.arrowHitPlayer.play(),t.stopped=!0,function(e){J({player:e,damage:100})}(u.object.playerUuid)}(s=l.intersectObjects(L,!0)).length>0&&(t.position.copy(s.pop().point),"rope"==t.type?re.grappleHit.play():re.arrowHitGround.play(),t.stopped=!0,J({arrow:{stopped:!0,position:t.position,uuid:t.uuid}}))}}),Object.keys(te).forEach(t=>{te[t].stopped||se(te[t],e)})}function de(){return Me.globalVector(ie)}re.arrowHitGround=Y(G.a),re.arrowHitPlayer=Y(K.a),re.grappleHit=Y($.a);var pe=o(26),me=o.n(pe),ge=o(27),we=o.n(ge),he=o(28),fe=o.n(he),be=o(29),ye=o.n(be);const ve=o(5);var xe={uuid:c()};const ke=7,Ae=1.3,Se=new n.ub(230,150,80);new n.d;var Le={};Le.bowShot=Y(me.a),Le.bowDraw=Y(we.a),Le.grappleShot=Y(fe.a),Le.grappleReel=Y(ye.a),xe.race=["black","brown","white"][Math.floor(3*Math.random())],r.load(ve("./benji_"+xe.race+".gltf"),e=>{xe.gltf=e,Object.keys(Le).forEach(e=>xe.gltf.scene.add(Le[e])),xe.velocity=new n.ub,xe.bowState="unequipped";var t,o=new n.b(e.scene);function i(e,t,o,n){return e.clone().projectOnPlane(xe.getPosition().normalize()).applyAxisAngle(xe.getPosition().normalize(),-Math.atan2(t.x,t.y)).normalize().multiplyScalar(n*function(e){return e.keyboard.shift?(xe.isRunning()&&(xe.anim[xe.activeMovement].timeScale=Ae),ke*Ae):(xe.anim[xe.activeMovement]&&(xe.anim[xe.activeMovement].timeScale=1),ke)}(o))}W(o,xe),o.addEventListener("finished",e=>{"Draw bow"==e.action.getClip().name?xe.bowState="drawn":"death"==e.action.getClip().name?S.remove(xe.gltf.scene):("Fire bow"==e.action.getClip().name&&(xe.bowState="equipped"),xe.idle())}),xe.falling=function(e){if(e){var t=xe.getPosition().add(xe.velocity.clone().multiplyScalar(e)).sub(this.globalVector(new n.ub(0,.1,0))),o=this.globalVector(new n.ub(0,1,0));return!(new n.hb(t,o,0,.2+xe.velocity.length()*e).intersectObjects(L,!0).length>0)||(xe.doubleJumped=!1,!1)}},xe.collisionDetected=function(e){var t,o,i;t=xe,l&&t.gltf.scene.children.forEach(e=>{"collision line"===e.name&&t.gltf.scene.remove(e)});for(var a=-1;a<=1;a++)for(var r=-1;r<=1;r++){if(o=this.globalVector(new n.ub(.5*a,1,.5*r).normalize()),i=new n.hb(e,o,0,1),s(xe,o),i.intersectObjects(L,!0).length>0)return o;var c=e.clone().sub(xe.getPosition());if((i=new n.hb(xe.getPosition().add(o),c.clone().normalize(),0,c.length())).intersectObjects(L,!0).length>0)return c}return!1},xe.playBowAction=function(e){xe.isRunning()&&"runWithLegsOnly"!=xe.activeMovement?xe.movementAction("runWithLegsOnly"):xe.activeMovement&&(xe.stopAction(xe.activeMovement),xe.activeMovement=null),xe.bowAction(e),xe.broadcast()},xe.onMouseDown=function(){null!=t?(t=null,ee.forEach(e=>{"rope"==e.type&&(e.type=null,S.remove(e.rope))}),Le.grappleReel.isPlaying&&Le.grappleReel.stop()):"unequipped"==xe.bowState?xe.equipBow():(this.activeActions.includes("jumping")&&this.stopAction("jumping"),Le.bowDraw.play(),xe.playBowAction("drawBow"),xe.bowState="drawing",F.zoomIn())},xe.onMouseUp=function(e){"drawn"==xe.bowState?(xe.playBowAction("fireBow"),2==e.button?(t=le("rope"),Le.grappleShot.play()):(Le.bowShot.play(),le("normal")),xe.bowState="firing",F.zoomOut()):"drawing"===xe.bowState&&(xe.stopAction(xe.activeBowAction),xe.activeBowAction=null,xe.bowState="equipped",xe.idle(),F.zoomOut())},xe.broadcast=async function(){J({player:xe.uuid,position:xe.getPosition(),rotation:xe.getRotation(),bowState:xe.bowState})},xe.doubleJumped=!1,xe.animate=function(e,o){var a,r,c=function(e){var t=0,o=0;if(0!=e.touch.x&&0!=e.touch.y){var i=new n.tb(e.touch.x,e.touch.y);i.length()>100?e.keyboard.shift=!0:e.keyboard.shift=!1,i.normalize(),t=i.x,o=i.y}return e.keyboard.forward&&(t+=0,o+=1),e.keyboard.backward&&(t+=0,o+=-1),e.keyboard.left&&(t+=-1,o+=0),e.keyboard.right&&(t+=1,o+=0),new n.tb(t,o)}(o),l=F.getWorldDirection(new n.ub),s=i(l,c,o,e),u=function(e){var t=e.clone();return t.applyQuaternion((new n.db).setFromUnitVectors(R.clone().normalize(),new n.ub(0,1,0))),new n.tb(t.x,t.z)}(l),d=function(e,t,o){return 0==t.length()&&(t=new n.tb(0,1)),e.clone().rotateAround(new n.tb,Math.atan2(t.x,t.y))}(u,c),p=xe.falling(e);if(!p&&S.loaded)if(0!=o.touch.x&&0!=o.touch.y||o.keyboard.forward||o.keyboard.backward||o.keyboard.left||o.keyboard.right){r=Math.atan2(d.x,d.y),xe.velocity.set(0,0,0),(a=xe.getPosition()).add(s);var m=a.clone().add(this.globalVector(new n.ub(0,.5,0))),g=new n.hb(m,this.globalVector(new n.ub(0,-1,0)),0,1).intersectObjects(L,!0);g.length>0&&(a=g[0].point.add(this.globalVector(new n.ub(0,.01,0)))),xe.isRunning()||("equipped"==xe.bowState?xe.movementAction("runWithBow"):xe.isFiring()?xe.movementAction("runWithLegsOnly"):xe.movementAction("running"))}else xe.isRunning()&&(xe.isFiring()?(xe.stopAction(xe.activeMovement),xe.activeMovement=null):xe.idle());else{var w=10;xe.doubleJumped&&xe.isFiring()&&(w=5),xe.velocity.sub(xe.getPosition().normalize().multiplyScalar(w*e))}if(xe.isFiring()&&(r=Math.atan2(u.x,u.y),F.updateCamera(),xe.broadcast()),o.jump&&!xe.doubleJumped&&(o.jump=null,p&&(xe.doubleJumped=!0),c.length()&&this.velocity.copy(s.clone().multiplyScalar(1/e)),this.velocity.add(this.getPosition().normalize().multiplyScalar(5)),this.playAction("jumping")),null!=t&&t.stopped){if(0!=c.length()){var h=l.clone().applyAxisAngle(this.getPosition().normalize(),-Math.atan2(c.x,c.y));this.velocity.add(h.multiplyScalar(15*e))}this.velocity.add(t.position.clone().sub(this.getPosition()).normalize().multiplyScalar(15*e)),Le.grappleReel.isPlaying||Le.grappleReel.play()}if(0!=xe.velocity.length()&&(a||(a=xe.getPosition()),a.add(xe.velocity.clone().multiplyScalar(e))),function(e,t){var o,i;i=e?e.clone().normalize():xe.getPosition().normalize();t?(xe.getRotation().copy(new n.p(0,t,0)),o=(new n.db).setFromUnitVectors(new n.ub(0,1,0),i)):e&&(o=(new n.db).setFromUnitVectors(xe.getPosition().normalize(),i));o&&xe.gltf.scene.applyQuaternion(o)}(a,r),a){var f=xe.collisionDetected(a);f?p?(xe.velocity.copy(f.clone().negate().normalize().multiplyScalar(10)),a.add(xe.velocity.clone().multiplyScalar(e)),xe.setPosition(a)):xe.velocity.set(0,0,0):(xe.setPosition(a),F.updateCamera()),xe.broadcast()}},xe.idle=function(){xe.movementAction("idle"),xe.broadcast()},xe.equipBow=function(){xe.bowState="equipped",xe.playBowAction("equipBow"),xe.toggleBow(!0)},xe.unequipBow=function(){xe.toggleBow(!1),xe.bowState="unequipped"},xe.takeDamage=function(){Ve(),this.playAction("death")},xe.respawn=function(){S.add(xe.gltf.scene),xe.setPosition(Se)},xe.sendChat=function(e){J({player:xe.uuid,chatMessage:e})},xe.activeActions=[],xe.playAction=function(e){this.anim[e]&&(this.anim[e].reset().play(),J({player:this.uuid,playAction:e}),this.activeActions.includes(e)||this.activeActions.push(e))},xe.stopAction=function(e){this.activeActions.includes(e)?(this.activeActions=this.activeActions.filter(t=>t!=e),this.anim[e].stop(),J({player:this.uuid,stopAction:e})):console.error("tried to stop action: "+e+", but action was never started")},xe.bowAction=function(e){this.anim&&this.anim[e]?this.activeBowAction!=e&&(this.activeBowAction&&(this.stopAction(this.activeBowAction),this.activeBowAction=null),this.activeMovement&&"runWithLegsOnly"!=this.activeMovement&&this.stopAction(this.activeMovement),e&&this.playAction(e),this.activeBowAction=e):console.error("action: "+e+" does not exist!")},xe.movementAction=function(e="idle"){if(this.anim&&this.anim[e]){if(this.activeMovement){if(this.activeMovement==e)return;this.stopAction(this.activeMovement)}this.playAction(e),this.activeMovement=e}else console.error("action: "+e+" does not exist!")},xe.setPosition(Se),xe.gltf.scene.applyQuaternion((new n.db).setFromUnitVectors(new n.ub(0,1,0),xe.getPosition().normalize())),S.add(xe.gltf.scene),J({player:xe.uuid,position:xe.getPosition(),race:xe.race}),xe.equipBow(),xe.idle()});var Me=xe,ze=new n.xb({antialias:!0,alpha:!0});ze.setClearColor("#e5e5e5"),ze.setSize(window.innerWidth,window.innerHeight,!1),ze.setPixelRatio(window.devicePixelRatio),ze.gammaOutput=!0,ze.gammaFactor=2.2,o.d(t,"start",function(){return Ze}),o.d(t,"gameOver",function(){return Ve}),o.d(t,"setKillCount",function(){return Te}),o(30);var Pe=new n.k;window.addEventListener("resize",function(){var e,t;e=window.innerWidth,t=window.innerHeight,_e&&window.innerWidth>window.innerHeight?(_e=!1,document.body.classList.remove("rotated")):_e&&(e=window.innerHeight,t=window.innerWidth);ze.setSize(e,t,!1),F.aspect=e/t,F.resetFocalLength(),F.updateProjectionMatrix()});var je={keyboard:{forward:!1,backward:!1,left:!1,right:!1,space:!1},touch:{x:0,y:0}},Be="playing",Oe=!1,Ee={id:null,x:null,y:null,shoot:!1},Fe={id:null,x:null,y:null},Ce={id:null};const qe=4,Re=[document.getElementById("shoot-button"),document.getElementById("rope-button"),document.getElementById("jump-button")];var _e;function De(){requestAnimationFrame(De);var e=Pe.getDelta();ue(e),Me&&Me.mixer&&(Me.animate(e,je),Me.mixer.update(e)),Object.keys(U.all()).length&&function(e){Object.keys(X).forEach(t=>{X[t].mixer&&X[t].mixer.update(e)})}(e),F.animate(e),S.animate(e),ze.render(S,F)}function He(e,t){if("string"==typeof e.key)switch(e.key.toLowerCase()){case"w":je.keyboard.forward=t;break;case"a":je.keyboard.left=t;break;case"s":je.keyboard.backward=t;break;case"d":je.keyboard.right=t;break;case" ":null!=je.jump?je.jump=t:t||(je.jump=!1);break;case"shift":je.keyboard.shift=t}}function We(e){13===e.keyCode&&document.getElementById("chat").classList.contains("chatting")&&Me.sendChat(document.getElementById("chat-text-box").value),He(e,!0)}function Ie(e){He(e,!1)}function Je(){"chat"==event.target.id?event.target.classList.add("chatting"):2!=event.button&&"paused"==Be&&(document.body.requestPointerLock&&document.body.requestPointerLock(),Xe()),"playing"==Be&&Me.onMouseDown()}function Ue(e){"playing"===Be&&Me.onMouseUp(e)}function Xe(){document.body.classList.remove("ready"),document.body.classList.add("playing"),Be="playing"}function Te(e){e,document.getElementById("kill-count").innerHTML+="X"}function Ve(){Be="gameOver",document.body.classList.remove("playing"),document.getElementById("title").innerHTML="Game over",document.body.classList.remove("playing"),document.body.classList.add("gameOver")}function Ye(){Be=document.pointerLockElement?"playing":"paused"}function Ne(e){e!=Oe&&(e?Re.forEach(e=>e.setAttribute("style","display: block;")):Re.forEach(e=>e.setAttribute("style","display: none;")),Oe=e)}function Ge(e){var t,o,n;e.preventDefault(),Ne(!0);for(var i=0;i<e.targetTouches.length;i++)e.targetTouches.item(i).identifier==Ee.id?t=e.targetTouches.item(i):e.targetTouches.item(i).identifier==Fe.id?o=e.targetTouches.item(i):null==n&&(n=e.targetTouches.item(i));t?(_e?F.moveCamera(qe*(t.pageY-Ee.y),-1*qe*(t.pageX-Ee.x)):F.moveCamera(qe*(t.pageX-Ee.x),qe*(t.pageY-Ee.y)),Ee.x=t.pageX,Ee.y=t.pageY):n&&("shoot-button"===n.target.id?(Me.onMouseDown(),Ee.shoot=!0):"rope-button"===n.target.id&&(Me.onMouseDown(),Ee.rope=!0),"jump-button"===n.target.id&&(je.jump=!0,Ce.id=n.identifier),(_e&&n.pageY>window.innerHeight/2||!_e&&n.pageX>window.innerWidth/2)&&(Ee.id=n.identifier,Ee.x=n.pageX,Ee.y=n.pageY)),o?_e?(je.touch.y=o.pageX-Fe.x,je.touch.x=o.pageY-Fe.y):(je.touch.x=o.pageX-Fe.x,je.touch.y=-1*(o.pageY-Fe.y)):n&&(_e&&n.pageY<window.innerHeight/2||!_e&&n.pageX<window.innerWidth/2)&&(Fe.id=n.identifier,Fe.x=n.pageX,Fe.y=n.pageY)}function Qe(e){Ee.id==e.changedTouches[0].identifier?(Ee.id==Ce.id&&(je.jump=!1),Ee.shoot&&Me.onMouseUp({button:0}),Ee.rope&&Me.onMouseUp({button:2}),Ee.id=null,Ee.shoot=!1,Ee.rope=!1):Fe.id==e.changedTouches[0].identifier&&(Fe.id=null,je.touch={x:0,y:0})}function Ke(e){"shoot-button"!=e.target.id&&"jump-button"!=e.target.id&&"rope-button"!=e.target.id&&Ne(!1);var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,o=e.movementY||e.mozMovementY||e.webkitMovementY||0;F.moveCamera(t,o)}function Ze(){document.addEventListener("mousemove",Ke),document.addEventListener("keydown",We),document.addEventListener("keyup",Ie),document.addEventListener("mousedown",Je),document.addEventListener("mouseup",Ue),document.addEventListener("pointerlockchange",Ye),document.addEventListener("touchstart",Ge),document.addEventListener("touchmove",Ge),document.addEventListener("touchend",Qe),document.body.appendChild(ze.domElement),Re.concat(ze.domElement).forEach(e=>new a.a.Manager(e,{recognizers:[[a.a.Pinch,{enable:!0}]]})),window.innerWidth<window.innerHeight&&document.body.requestPointerLock&&document.body.requestPointerLock()&&screen.orientation.type&&screen.orientation.type.includes("portrait")&&(document.body.requestFullscreen?document.body.requestFullscreen():document.body.mozRequestFullScreen?document.body.mozRequestFullScreen():document.body.webkitRequestFullscreen?document.body.webkitRequestFullscreen():document.body.msRequestFullscreen&&document.body.msRequestFullscreen(),document.body.classList.add("rotated"),_e=!0),De(),Xe()}je.jump=0,document.getElementById("respawn").onclick=function(){Me.respawn(),Xe()}},,function(e,t,o){e.exports=o.p+"models/battle_planet.glb"},function(e,t,o){var n={"./Characters_Black.png":14,"./Characters_Brown.png":15,"./Characters_White.png":16,"./battle_planet.glb":4,"./benji.bin":17,"./benji.gltf":18,"./benji_black.gltf":19,"./benji_brown.gltf":20,"./benji_white.gltf":21,"./env.glb":22};function i(e){var t=a(e);return o(t)}function a(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=a,e.exports=i,i.id=5},,,function(e,t,o){e.exports=o.p+"skybox/yellowcloud_ft.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_bk.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_up.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_dn.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_rt.jpg"},function(e,t,o){e.exports=o.p+"skybox/yellowcloud_lf.jpg"},function(e,t,o){e.exports=o.p+"models/Characters_Black.png"},function(e,t,o){e.exports=o.p+"models/Characters_Brown.png"},function(e,t,o){e.exports=o.p+"models/Characters_White.png"},function(e,t,o){e.exports=o.p+"models/benji.bin"},function(e,t,o){e.exports=o.p+"models/benji.gltf"},function(e,t,o){e.exports=o.p+"models/benji_black.gltf"},function(e,t,o){e.exports=o.p+"models/benji_brown.gltf"},function(e,t,o){e.exports=o.p+"models/benji_white.gltf"},function(e,t,o){e.exports=o.p+"models/env.glb"},function(e,t,o){e.exports=o.p+"audio/effects/Arrow to Ground.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Arrow to Player.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Grapple Hit.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Bow Shot.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Bow Draw.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Grapple Shot.mp3"},function(e,t,o){e.exports=o.p+"audio/effects/Grapple Reel Loop.mp3"},function(e,t,o){var n={"./bow-and-arrow.svg":31,"./crosshair.svg":32,"./dot-and-circle.svg":33,"./fullscreen.svg":34,"./rope.svg":35};function i(e){var t=a(e);return o(t)}function a(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=a,e.exports=i,i.id=30},function(e,t,o){e.exports=o.p+"icons/bow-and-arrow.svg"},function(e,t,o){e.exports=o.p+"icons/crosshair.svg"},function(e,t,o){e.exports=o.p+"icons/dot-and-circle.svg"},function(e,t,o){e.exports=o.p+"icons/fullscreen.svg"},function(e,t,o){e.exports=o.p+"icons/rope.svg"}]]);