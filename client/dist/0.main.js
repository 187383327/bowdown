(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,function(e,n,o){"use strict";o.r(n);var t=o(2),i=new(o(4).a),a=o(5),c=o.n(a),r=o(6),s=o.n(r),d=o(7),l=o.n(d),u=o(8),p=o.n(u),w=o(9),m=o.n(w),b=o(10),f=o.n(b),y=o(11),v=o.n(y),g=new t.fb,h=[];i.load(c.a,function(e){var n=e.scene;n.position.y-=10,g.add(n),h.push(n)});let x=[];x.push(new t.M({map:(new t.lb).load(s.a)})),x.push(new t.M({map:(new t.lb).load(l.a)})),x.push(new t.M({map:(new t.lb).load(p.a)})),x.push(new t.M({map:(new t.lb).load(m.a)})),x.push(new t.M({map:(new t.lb).load(f.a)})),x.push(new t.M({map:(new t.lb).load(v.a)}));for(let e=0;e<6;e++)x[e].side=t.c;let k=new t.e(1e3,1e3,1e3),M=new t.L(k,x);var z;g.add(M),g.add(((z=new t.r(16777215,10209703)).color.setHSL(.6,1,.8),z.groundColor.setHSL(.095,1,.75),z.position.set(0,50,0),z.visible=!0,z)),g.add(function(){var e=new t.l(16777215,1);e.color.setHSL(.1,1,.95),e.position.set(-1,1.75,1),e.position.multiplyScalar(30),e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048;return e.shadow.camera.left=-50,e.shadow.camera.right=50,e.shadow.camera.top=50,e.shadow.camera.bottom=-50,e.shadow.camera.far=3500,e.shadow.bias=-1e-4,e.visible=!0,e}());var A=new t.tb({antialias:!0,alpha:!0});function S(e,n){var o;return e.forEach(e=>{e.name!==n||(o=e)}),o}function q(e,n){n.mixer=e,n.anim={idle:e.clipAction(S(n.animations,"Idle")),running:e.clipAction(S(n.animations,"Running2")),runWithBow:e.clipAction(S(n.animations,"Run with bow")),runWithLegsOnly:e.clipAction(S(n.animations,"Running legs only")),jumping:e.clipAction(S(n.animations,"Jumping")).setLoop(t.H),equipBow:e.clipAction(S(n.animations,"Equip Bow")).setLoop(t.H),drawBow:e.clipAction(S(n.animations,"Draw bow")).setLoop(t.H),fireBow:e.clipAction(S(n.animations,"Fire bow")).setLoop(t.H)},n.anim.drawBow.clampWhenFinished=!0,n.toggleBow=function(e){n.scene.children[0].children[1].visible=!e,n.scene.children[0].children[2].visible=e},n.bowAction=function(e){n.activeBowAction!=e&&(e&&n.anim[e].reset().play(),n.activeBowAction=e)},n.movementAction=function(e="idle"){if(n.anim&&n.anim[e]){if(n.activeMovement){if(n.activeMovement==e)return;n.anim[n.activeMovement].stop()}n.anim[e].reset().play(),n.activeMovement=e}else console.error("action: "+e+" does not exist!")},n.isRunning=function(){return!!n.activeMovement&&n.activeMovement.toLowerCase().includes("run")},n.isFiring=function(){return n.bowState&&("drawn"==n.bowState||"drawing"==n.bowState||"firing"==n.bowState)}}A.setClearColor("#e5e5e5"),A.setPixelRatio(window.devicePixelRatio),A.setSize(window.innerWidth,window.innerHeight),A.gammaOutput=!0,A.gammaFactor=2.2;var L=o(3),B=o.n(L);const E=new WebSocket("ws://ec2-18-191-136-250.us-east-2.compute.amazonaws.com:18181");function j(e){E.readyState&&E.send(JSON.stringify(e))}E.onopen=function(){j({message:"sup fucker"})},E.onmessage=function(e){var n,o;if((e=JSON.parse(e.data)).players&&O.init(e.players),e.player){var i=e.player;i==J?e.damage&&Y.takeDamage(e.damage):O.get(i)?"disconnected"===e.status?(g.remove(O.get(i).scene),O.get(i)):O.get(i).scene&&null!=e.x&&null!=e.y&&null!=e.z&&null!=e.rotation&&O.move(i,new t.qb(e.x,e.y,e.z),e.rotation,e.movementAction,e.bowAction):O.add(i,new t.qb(e.x,e.y,e.z))}else e.arrow&&(n=e.arrow,(o=I(n.origin,n.rotation)).velocity=new t.qb(n.velocity.x,n.velocity.y,n.velocity.z),F.push(o),X(o,(Date.now()-n.timeOfShoot)/1e3))};var O={},W={},D=[];O.all=function(){return W},O.get=e=>W[e],O.add=function(e,n){W[e]="loading",i.load(B.a,function(o){W[e]=o,q(new t.b(o.scene),o),n&&O.move(e,n,0),g.add(o.scene);var i=new t.L(new t.e(.5,2,.5));i.position.y+=1,i.material.visible=!1,o.scene.add(i),i.playerUuid=e,D.push(i)})},O.init=function(e){Object.keys(e).forEach(n=>{O.add(n,new t.qb(e[n].x,e[n].y,e[n].z))})},O.move=function(e,n,o,t,i){var a=W[e];a.scene.position.copy(n),a.scene.rotation.y=o,t&&a.movementAction(t),i&&a.bowAction(i)};var C=[],F=[],P=.06,H=.75;function I(e,n){var o=new t.e(P,P,H),i=new t.M({color:65280}),a=new t.L(o,i);return a.origin=e,a.position.copy(e),a.rotation.copy(n),g.add(a),a}function X(e,n){e.velocity.y-=9*n,e.position.add(e.velocity.clone().multiplyScalar(n))}function R(e){C.forEach(n=>{if(!n.stopped){X(n,e);var o=new t.qb(0,0,1);o.applyEuler(n.rotation).normalize();var i=n.position.clone().sub(n.origin).length()/2,a=new t.db(n.position,o,0,i),c=a.intersectObjects(D);if(c.length>0){var r=c.pop();n.position.copy(r.point),n.stopped=!0,function(e){j({player:e,damage:100})}(r.object.playerUuid)}(c=a.intersectObjects(h,!0)).length>0&&(n.position.copy(c.pop().point),n.stopped=!0)}}),F.forEach(n=>{X(n,e)})}var Y,T,J="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)});const U=.12;i.load(B.a,e=>{(Y=e).velocity=new t.qb,Y.bowState="unequipped",g.add(e.scene),q(T=new t.b(e.scene),Y),T.addEventListener("finished",e=>{"Draw bow"==e.action.getClip().name?Y.bowState="drawn":("Fire bow"==e.action.getClip().name&&(Y.bowState="equipped"),Y.moveAction("idle"))}),Y.falling=function(){var e=new t.qb(0,-1,0);e=e.clone().normalize();var n=new t.db(new t.qb(Y.scene.position.x,Y.scene.position.y+.9,Y.scene.position.z),e).intersectObjects(h,!0);return!(n.length>0&&n[0].distance<=new t.y(new t.qb,e).distance())};Y.collisionDetected=function(e){for(var n=-1;n<=1;n++)for(var o=-1;o<=1;o++){n*=.5,o*=.5;var i=new t.qb(n,1,o);i=i.clone().normalize();var a=new t.db(new t.qb(e.x,e.y,e.z),i).intersectObjects(h,!0);if(a.length>0&&a[0].distance<=new t.y(new t.qb,i).distance())return!0}return!1},Y.moveAction=function(e){Y.movementAction(e),Y.broadcast()},Y.playBowAction=function(e){Y.isRunning()&&"runWithLegsOnly"!=Y.activeMovement?Y.moveAction("runWithLegsOnly"):Y.activeMovement&&(Y.anim[Y.activeMovement].stop(),Y.activeMovement=null),Y.bowAction(e),Y.broadcast()},Y.jump=function(){Y.velocity.y=5,Y.moveAction("jumping")},Y.onMouseDown=function(){"unequipped"==Y.bowState?Y.equipBow():(Y.playBowAction("drawBow"),Y.bowState="drawing",Z.zoomIn())},Y.onMouseUp=function(){"drawn"==Y.bowState?(Y.playBowAction("fireBow"),Y.anim.drawBow.stop(),function(){var e=Y.scene.position.clone().add(new t.qb(0,1.5,0)),n=I(e,Z.rotation),o=new t.db;o.setFromCamera({x:0,y:0},Z);var i,a=o.intersectObjects(h.concat(D),!0);a.length>0?i=a[0].point.sub(e):(i=new t.qb,Z.getWorldDirection(i)),n.velocity=i.normalize().multiplyScalar(60),C.push(n),j({arrow:{origin:n.position,rotation:n.rotation,velocity:n.velocity,timeOfShoot:Date.now()}})}(),Y.bowState="firing",Z.zoomOut()):"drawing"===Y.bowState&&(Y.anim.drawBow.stop(),Y.bowAction(),Y.bowState="equipped",Y.moveAction("idle"),Z.zoomOut())},Y.broadcast=async function(){j({player:J,x:Y.scene.position.x,y:Y.scene.position.y,z:Y.scene.position.z,rotation:Y.scene.rotation.y,movementAction:Y.activeMovement,bowAction:Y.activeBowAction,bowState:Y.bowState})},Y.move=function(e,n=Y.scene.rotation.y){if(Y.collisionDetected(e))Y.velocity.set(0,0,0);else{if(Y.scene.position.copy(e),Y.isFiring()){var o=new t.qb;Z.getWorldDirection(o),n=Math.atan2(o.x,o.z)}Y.scene.rotation.y=n,Z.updateCamera(),Y.broadcast()}},Y.animate=function(e,n){var o=new t.qb;if(Y.falling())Y.velocity.y-=10*e,o=Y.scene.position.clone().add(Y.velocity.clone().multiplyScalar(e)),Y.move(o);else{Y.velocity.set(0,0,0);var i=function(e){var n=new t.qb;Z.getWorldDirection(n),(n=new t.pb(n.x,n.z)).normalize().multiplyScalar(U);var o=0,i=0;if(0!=e.touch.x&&0!=e.touch.y){var a=new t.pb(e.touch.x,e.touch.y).normalize();o=a.x,i=a.y}return e.keyboard.forward&&(o+=0,i+=1),e.keyboard.backward&&(o+=0,i+=-1),e.keyboard.left&&(o+=-1,i+=0),e.keyboard.right&&(o+=1,i+=0),n.rotateAround(new t.pb,Math.atan2(o,i))}(n),a=Math.atan2(i.x,i.y);if(n.keyboard.space&&Y.jump(),0!=n.touch.x&&0!=n.touch.y||n.keyboard.forward||n.keyboard.backward||n.keyboard.left||n.keyboard.right){o.z=Y.scene.position.z+i.y,o.x=Y.scene.position.x+i.x,Y.velocity.x=(o.x-Y.scene.position.x)/e,Y.velocity.z=(o.z-Y.scene.position.z)/e,o.y=Y.scene.position.y;var c=new t.qb(o.x,o.y+1,o.z),r=new t.db(c,new t.qb(0,-1,0)).intersectObjects(h,!0);r.length>0&&(o.y=r[0].point.y+.01),Y.move(o,a),Y.isRunning()||("equipped"==Y.bowState?Y.moveAction("runWithBow"):Y.isFiring()?Y.moveAction("runWithLegsOnly"):Y.moveAction("running"))}else if(Y.isRunning()&&Y.moveAction("idle"),Y.isFiring()){i=new t.qb;Z.getWorldDirection(i),a=Math.atan2(i.x,i.z),Y.scene.rotation.y=a,Z.updateCamera(),Y.broadcast()}n.keyboard.space&&(o=Y.scene.position.clone().add(Y.velocity.clone().multiplyScalar(e)),Y.move(o))}},Y.equipBow=function(){Y.bowState="equipped",Y.playBowAction("equipBow"),Y.toggleBow(!0)},Y.unequipBow=function(){Y.toggleBow(!1),Y.bowState="unequipped"},Y.takeDamage=function(){Y.scene.position.y-=20},Y.unequipBow(),Y.moveAction("idle")});var Z=new t.V(75,window.innerWidth/window.innerHeight,.1,3e3);Z.defaultZoom=Z.getFocalLength(),Z.position.z=5;var N=new t.qb(0,1,0),V=0,G=0;Z.nextPosition=function(e){if(null!=Y){var n=new t.qb;return n.x=N.x+e*Math.sin(V*Math.PI/360)*Math.cos(G*Math.PI/360),n.y=N.y+e*Math.sin(G*Math.PI/360),n.z=N.z+e*Math.cos(V*Math.PI/360)*Math.cos(G*Math.PI/360),n}},Z.zoomIn=function(){Z.setFocalLength(Z.defaultZoom+4)},Z.zoomOut=function(){Z.setFocalLength(Z.defaultZoom)},Z.setPosition=function(e){Z.position.copy(e)},Z.updateCamera=function(){if(null!=Y){var e=Y.scene.position.clone().sub(Z.position.clone()),n=new t.qb(-e.z,0,e.x).normalize();N.copy(Y.scene.position.clone().add(n)).setY(Y.scene.position.y+1);var o=Z.nextPosition(3.5),i=new t.db(N,o.clone().sub(N).normalize(),0,5).intersectObjects(h,!0);i.length>0&&(o=i[0].point.clone().sub(o.clone().sub(i[0].point).normalize().multiplyScalar(.1))),Z.setPosition(o)}Z.lookAt(N),Z.updateMatrix()},Z.moveCamera=function(e,n){V-=.2*e;var o=G+.2*n;135>=o&&o>=-80&&(G=o),Z.updateCamera()},o.d(n,"start",function(){return be});var K=new t.i;document.body.appendChild(A.domElement),window.addEventListener("resize",function(){A.setSize(window.innerWidth,window.innerHeight),Z.aspect=window.innerWidth/window.innerHeight,Z.updateProjectionMatrix()});var Q={keyboard:{forward:!1,backward:!1,left:!1,right:!1,space:!1},touch:{x:0,y:0}},$="ready",_=!1,ee={id:null,x:null,y:null,shoot:!1},ne={id:null,x:null,y:null};const oe=document.getElementById("shoot-button");function te(){requestAnimationFrame(te);var e=K.getDelta();R(e),Y&&T&&(Y.animate(e,Q),T.update(e)),Object.keys(O.all()).length&&function(e){Object.keys(W).forEach(n=>{W[n].mixer&&W[n].mixer.update(e)})}(e),A.render(g,Z)}function ie(e,n){switch(e.key){case"w":Q.keyboard.forward=n;break;case"a":Q.keyboard.left=n;break;case"s":Q.keyboard.backward=n;break;case"d":Q.keyboard.right=n;break;case" ":Q.keyboard.space=n}}function ae(e){ie(e,!0)}function ce(e){ie(e,!1)}function re(){"playing"===$&&Y.onMouseDown()}function se(){"playing"===$&&Y.onMouseUp()}function de(){"playing"!==$&&(document.body.requestPointerLock(),$="playing")}function le(){document.pointerLockElement||($="ready")}function ue(e){e!=_&&(e?oe.setAttribute("style","display: block;"):oe.setAttribute("style","display: none;"),_=e)}function pe(e){var n,o,t;e.preventDefault(),ue(!0);for(var i=0;i<e.targetTouches.length;i++)e.targetTouches.item(i).identifier==ee.id?n=e.targetTouches.item(i):e.targetTouches.item(i).identifier==ne.id?o=e.targetTouches.item(i):null==t&&(t=e.targetTouches.item(i));n?(Z.moveCamera(4*(n.pageX-ee.x),4*(n.pageY-ee.y)),ee.x=n.pageX,ee.y=n.pageY):t&&("shoot-button"===t.target.id&&(Y.onMouseDown(),ee.shoot=!0),t.pageX>window.innerWidth/2&&(ee.id=t.identifier,ee.x=t.pageX,ee.y=t.pageY)),o?(Q.touch.x=o.pageX-ne.x,Q.touch.y=-1*(o.pageY-ne.y)):t&&t.pageX<window.innerWidth/2&&(ne.id=t.identifier,ne.x=t.pageX,ne.y=t.pageY)}function we(e){ee.id==e.changedTouches[0].identifier?(ee.shoot&&Y.onMouseUp(),ee.id=null,ee.shoot=!1):ne.id==e.changedTouches[0].identifier&&(ne.id=null,Q.touch={x:0,y:0})}function me(e){"shoot-button"!=e.target.id&&ue(!1);var n=e.movementX||e.mozMovementX||e.webkitMovementX||0,o=e.movementY||e.mozMovementY||e.webkitMovementY||0;Z.moveCamera(n,o)}function be(){document.addEventListener("mousemove",me),document.addEventListener("keydown",ae),document.addEventListener("keyup",ce),document.addEventListener("click",de),document.addEventListener("mousedown",re),document.addEventListener("mouseup",se),document.addEventListener("pointerlockchange",le),document.addEventListener("touchstart",pe),document.addEventListener("touchmove",pe),document.addEventListener("touchend",we),te(),document.getElementById("crosshair").setAttribute("style","display: block;")}},,function(e,n,o){e.exports=o.p+"aaa61a2e8305b0eb326a110017161ff0.glb"},,function(e,n,o){e.exports=o.p+"baae041779d88e3f44e7b73d83d4b782.glb"},function(e,n,o){e.exports=o.p+"7892e5f13382f146373e2feee6999074.jpg"},function(e,n,o){e.exports=o.p+"bfbf6e3b2e9c92cee83c5cb73c602dff.jpg"},function(e,n,o){e.exports=o.p+"f900c2f67538e778beaa220d765ddb86.jpg"},function(e,n,o){e.exports=o.p+"dd72bb23dae86654c0018bf2164773ea.jpg"},function(e,n,o){e.exports=o.p+"40cb740f2b07e44047f4ca7823a46d21.jpg"},function(e,n,o){e.exports=o.p+"cf70fe3d246583aa691b7ff3fde1d03b.jpg"}]]);